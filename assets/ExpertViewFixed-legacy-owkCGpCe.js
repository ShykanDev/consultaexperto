System.register(["./index-legacy-7K6bEPb_.js","./expertUi-legacy-5cJL3jzZ.js","./index-legacy-CPnhazDU.js","./stars-legacy-um4h9HOd.js","./hiring-legacy-BOLO7fQ1.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,t){"use strict";var a,l,s,i,r,n,o,d,u,c,v,p,b,x,g,m,f,h,y,w,k,U,B,C,_,A,E,j,D,N,S,$,F,I,M;return{setters:[e=>{a=e.a,l=e.k,s=e.u,i=e.Z,r=e.i,n=e.L,o=e.j,d=e.l,u=e.m,c=e.r,v=e.b,p=e.o,b=e.e,x=e.n,g=e.c,m=e.f,f=e.w,h=e.g,y=e.t,w=e.X,k=e.B,U=e.F,B=e.x,C=e.q,_=e.W,A=e.J,E=e.G,j=e.a4,D=e.V,N=e.a2},e=>{S=e.u},e=>{$=e.e},e=>{F=e.u},e=>{I=e.u},e=>{M=e._}],execute:function(){var t=document.createElement("style");t.textContent=".scrollbar-hide[data-v-49004d2c]::-webkit-scrollbar{display:none}.scrollbar-hide[data-v-49004d2c]{-ms-overflow-style:none;scrollbar-width:none}.bg-white\\/20[data-v-49004d2c]{background-color:rgba(255,255,255,.2)}.rounded-3xl[data-v-49004d2c]{border-radius:1.5rem}.transition-all[data-v-49004d2c]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.3s}\n",document.head.appendChild(t);const O={class:"min-h-screen bg-[#F8FAFC] pb-10 font-manrope"},V={class:"px-4 sm:px-6 lg:px-8 pt-28 mt-5"},H={key:0,class:"animate-pulse space-y-8"},L={key:1,class:"space-y-2"},P={key:0,class:"bg-blue-50 border-l-4 border-blue-600 p-6 rounded-2xl shadow-sm flex flex-col md:flex-row items-center justify-between gap-6"},T={class:"flex items-start gap-4"},J={class:"p-3 bg-blue-100 rounded-xl text-blue-600"},q={class:"text-blue-700 text-sm mt-1"},z={class:"font-bold underline"},X={class:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start"},Y={class:"lg:col-span-4 space-y-6"},Z={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 overflow-hidden border border-slate-100 group"},G={class:"p-8 text-center"},K={class:"relative inline-block mb-6"},R={class:"w-32 h-32 rounded-[2rem] overflow-hidden ring-4 ring-offset-4 ring-blue-500 transition-all group-hover:scale-105"},W=["src","alt"],Q={class:"text-2xl font-extrabold text-slate-800 tracking-tight"},ee={class:"text-blue-600 font-semibold text-sm mt-1 uppercase tracking-wider"},te={key:0,class:"mt-2 inline-flex items-center px-3 py-1 rounded-full bg-red-50 text-red-600 text-xs font-bold border border-red-100"},ae={class:"mt-6 flex items-center justify-center gap-2 bg-slate-50 rounded-2xl py-3 px-4"},le={class:"flex items-center gap-1"},se={class:"text-xl font-bold text-slate-800"},ie={class:"text-xs text-slate-500 font-medium"},re={class:"border-t border-slate-100 bg-slate-50/50 p-6 space-y-4"},ne={class:"flex items-center justify-between"},oe={class:"text-sm font-semibold text-slate-700"},de={class:"flex items-center justify-between"},ue={class:"text-sm font-semibold text-slate-700"},ce={class:"bg-white rounded-[2rem] p-6 shadow-sm border border-slate-100 grid grid-cols-2 gap-4"},ve={class:"p-4 bg-blue-50 rounded-2xl text-center"},pe={class:"text-2xl font-bold text-blue-700"},be={class:"lg:col-span-8 space-y-8"},xe={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden"},ge={class:"p-8 pb-0 flex flex-col sm:flex-row sm:items-center justify-between gap-4"},me={class:"flex items-center gap-3"},fe={class:"p-2.5 bg-blue-600 rounded-xl text-white shadow-lg shadow-blue-200"},he={key:0,class:"flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-xl border border-blue-100 ring-1 ring-blue-100"},ye={class:"text-xs font-bold"},we={class:"p-4"},ke={key:0,class:"flex overflow-x-auto gap-6 pb-2 scrollbar-hide"},Ue={class:"text-center py-2 bg-slate-50 rounded-xl border border-slate-100 text-blue-700 font-bold text-sm"},Be={class:"space-y-3"},Ce=["onClick","disabled"],_e={class:"text-[9px] uppercase tracking-widest opacity-80"},Ae={key:1,class:"text-center py-12 bg-slate-50 rounded-[2rem] border-2 border-dashed border-slate-200"},Ee={key:0,class:"bg-gradient-to-r from-blue-700 to-blue-700 p-6 flex flex-col md:flex-row items-center justify-between gap-6"},je={class:"flex items-center gap-4"},De={class:"p-3 bg-white/20 rounded-2xl text-white backdrop-blur-md"},Ne={class:"text-white font-bold text-lg md:text-xl"},Se=["disabled"],$e={key:0,class:"fixed inset-0 z-[100] flex flex-col items-center justify-center bg-blue-900/40 backdrop-blur-sm transition-all"},Fe={class:"relative"},Ie={class:"absolute inset-0 flex items-center justify-center"},Me={class:"mt-4 text-white font-bold text-lg tracking-wide"};e("default",M(a({__name:"ExpertViewFixed",setup(e){const{calcStarsValue:t}=F(),a=l(!1),M=l(""),Oe=s(),Ve=l(!1),He={Domingo:0,Lunes:1,Martes:2,Miercoles:3,"Miércoles":3,Jueves:4,Viernes:5,Sabado:6,"Sábado":6},Le=i(()=>{var e;const t=null===(e=Qe.value)||void 0===e?void 0:e.schedule,a={};return["Lunes","Martes","Miercoles","Jueves","Viernes","Sábado"].forEach(e=>{null!=t&&t[e]&&(a[e]=t[e])}),a}),Pe=r(),Te=n(),Je=l(null),qe=(e,t)=>{const a=He[e];if(void 0===a)throw new Error("Día inválido");const[l,s]=t.trim().split(":").map(Number),i=new Date,r=a-i.getDay(),n=new Date(i);return n.setDate(i.getDate()+r),n.setHours(l,s,0,0),n<=i&&n.setDate(n.getDate()+7),n},ze=e=>{const t=new Date;return e.getTime()-t.getTime()>=864e5},Xe=(e,t)=>{if(Ge.value)return void Oe.warning("No puede agendar horarios si ya tiene citas agendadas");if(!Te.getIsAuth&&(Pe.push("/login"),1))return;const a=Le.value[e];if(!a)return;const l=a.find(e=>e.time===t);if(!l)return;if(l.isAvailable)return void Oe.warning(`El horario de las ${l.time} no está disponible`);if(null!=l.takenBy&&l.takenBy!=n().getUserUid)return void Oe.warning(`El horario de las ${l.time} ya está tomado por otro usuario`);if(l.takenBy==n().getUserUid&&null!=l.takenAt)return void Oe.warning(`El horario de las ${l.time} ya está tomado por usted`);let s;try{if(s=qe(e,l.time),!ze(s))return void Oe.warning("No es posible agendar con menos de 24 horas de anticipación.")}catch(r){return void Oe.error("Error al calcular fecha de cita")}const i=Object.values(Le.value).flat(1).find(e=>e.takenBy==n().getUserUid&&!e.takenAt);if(i&&i!==l&&(i.takenBy=null),l.takenBy==n().getUserUid)l.takenBy=null,Je.value=null,Re.value=null;else{l.takenBy=n().getUserUid,Je.value=l;const e={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},t=s.toLocaleDateString("es-ES",e);Re.value=t.charAt(0).toUpperCase()+t.slice(1)}},Ye=o(),Ze=async()=>{var e,t,l,s;if(!Je.value)return void Oe.warning("No se ha seleccionado ningún horario");if(null!==(e=Qe.value)&&void 0!==e&&e.isSuspended||null!==(t=Qe.value)&&void 0!==t&&t.isBanned)return void Oe.error("No puede agendar horarios con este experto.");if(Ge.value)return void Oe.error("Ya tiene una cita agendada.");const i=Object.keys(Le.value).find(e=>Le.value[e].includes(Je.value));if(!i)return;const r=qe(i,Je.value.time);if(!ze(r))return void Oe.error("Mínimo 24 horas de anticipación requeridas.");a.value=!0,M.value="Asegurando tu cita...",Ve.value=!0;const o=`${null===(l=Qe.value)||void 0===l?void 0:l.userUid}_${i}_${Je.value.time}`,d=A(Ye,"bookings",o),u=A(Ye,`experts/${null===(s=Qe.value)||void 0===s?void 0:s.userUid}`),c=A(E(Ye,"schedules"));try{await j(Ye,async e=>{var t,a,l,s,o;const v=await e.get(d),p=await e.get(u);if(v.exists())throw new Error("Este horario ya fue reservado.");if(!p.exists())throw new Error("El experto no existe.");const b=(null===(t=p.data())||void 0===t?void 0:t.schedule)||{},x=(b[i]||[]).find(e=>e.time===Je.value.time);if(!x||x.takenBy&&x.takenBy!==n().getUserUid)throw new Error("El horario ya no está disponible.");x.takenBy=n().getUserUid,x.takenAt=D.now(),e.set(d,{reserverUid:n().getUserUid,createdAt:D.now()}),e.update(u,{schedule:b}),e.set(c,{userName:n().getUserName,userUid:n().getUserUid,expertUid:null===(a=Qe.value)||void 0===a?void 0:a.userUid,expertName:null===(l=Qe.value)||void 0===l?void 0:l.fullName,expertSchedule:Je.value,expertSpecialty:null===(s=Qe.value)||void 0===s?void 0:s.specialty,expertProfessionalId:null===(o=Qe.value)||void 0===o?void 0:o.professionalId,appointmentLink:"",isFinished:!1,dayName:i,appointmentDate:D.fromDate(r),createdAt:D.now(),acceptedByExpert:!1})}),Oe.success("¡Cita agendada con éxito!"),setTimeout(()=>Pe.push("/appointments"),1500)}catch(v){Oe.error(v.message||"Error al agendar la cita."),Ve.value=!1,a.value=!1,Je.value&&(Je.value.takenBy=null)}},Ge=l(!1),Ke=l(""),Re=l(null),We=l(!1),Qe=l(null);let et;const tt=async()=>{const e=S().getExpertUid;if(!e)return We.value=!0,!1;const t=A(Ye,`experts/${e}`);et=N(t,e=>{e.exists()?(Qe.value=e.data(),(()=>{var e;const t=null===(e=Qe.value)||void 0===e?void 0:e.schedule;if(Ge.value=!1,Ke.value="",t)for(const[a,l]of Object.entries(t)){const e=l.find(e=>e.takenBy==n().getUserUid&&e.takenAt);if(e){Ge.value=!0,Ke.value=`${a} a las ${e.time}`;break}}})(),We.value=!0):Oe.error("No se encontró al experto")})};d(async()=>{await tt(),$.init({blockHeadless:!0,publicKey:"8uRc3wp2ZXACkO_Eb"})}),u(()=>{et&&et()});const at=e=>{if(!e)return!1;const t=n().getUserData;if(null==t||!t.categoryConsultations)return!0;const a=t.categoryConsultations[e];return!a||a.hasFreeConsult},lt=I(),st=()=>{Qe.value&&(lt.setExpertHiringData(Qe.value.fullName,Qe.value.specialty,Qe.value.userUid),Pe.push("/hiring"))};return(e,l)=>{var s,i,r,o,d,u,A,E,j,D,N,S;const $=c("v-icon");return p(),v("div",O,[b("main",V,[We.value?(p(),v("div",L,[m(w,{"enter-active-class":"animate__animated animate__fadeInDown"},{default:f(()=>{var e,t;return[at(null===(e=Qe.value)||void 0===e?void 0:e.specialty)?x("",!0):(p(),v("div",P,[b("div",T,[b("div",J,[m($,{name:"ri-error-warning-line",scale:"1.5",animation:"ring"})]),b("div",null,[l[3]||(l[3]=b("h4",{class:"text-blue-900 font-bold text-lg"},"Citas gratuitas agotadas",-1)),b("p",q,[l[1]||(l[1]=h(" Has completado tus citas gratuitas en la categoría ",-1)),b("span",z,y(null===(t=Qe.value)||void 0===t?void 0:t.specialty),1),l[2]||(l[2]=h(". Contrata al experto para continuar con tu asesoría profesional. ",-1))])])]),b("button",{onClick:st,class:"w-full md:w-auto px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-2xl shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-2 group"},[l[4]||(l[4]=b("span",null,"Contratar Ahora",-1)),m($,{name:"bi-person-badge",class:"group-hover:translate-x-1 transition-transform"})])]))]}),_:1}),b("div",X,[b("aside",Y,[b("div",Z,[b("div",G,[b("div",K,[b("div",R,[b("img",{class:"w-full h-full object-cover",src:(null===(s=Qe.value)||void 0===s?void 0:s.profilePicture)||"https://ui-avatars.com/api/?name="+(null===(i=Qe.value)||void 0===i?void 0:i.fullName)+"&background=0D8ABC&color=fff",alt:null===(r=Qe.value)||void 0===r?void 0:r.fullName},null,8,W)]),l[5]||(l[5]=b("div",{class:"absolute -bottom-2 -right-2 bg-green-500 w-8 h-8 rounded-full border-4 border-white shadow-sm",title:"Expert Verified"},null,-1))]),b("h1",Q,y(null===(o=Qe.value)||void 0===o?void 0:o.fullName),1),b("p",ee,y(null===(d=Qe.value)||void 0===d?void 0:d.specialty),1),null!==(u=Qe.value)&&void 0!==u&&u.isSuspended?(p(),v("div",te,[m($,{name:"ri-error-warning-line",scale:"0.8",class:"mr-1"}),l[6]||(l[6]=h(" Suspendido ",-1))])):x("",!0),b("div",ae,[b("div",le,[m($,{name:"io-star",class:"text-yellow-500",scale:"1.1"}),b("span",se,y(k(t)(null===(A=Qe.value)||void 0===A?void 0:A.rating).toFixed(1)),1)]),l[7]||(l[7]=b("div",{class:"h-4 w-px bg-slate-200"},null,-1)),b("span",ie,y(null===(E=Qe.value)||void 0===E||null===(E=E.rating)||void 0===E?void 0:E.count)+" Calificaciones",1)])]),b("div",re,[b("div",ne,[l[8]||(l[8]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Cédula Profesional",-1)),b("span",oe,y((null===(j=Qe.value)||void 0===j?void 0:j.professionalId)||"No registrada"),1)]),b("div",de,[l[9]||(l[9]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Años de Exp.",-1)),b("span",ue,y((null===(D=Qe.value)||void 0===D?void 0:D.experienceYears)||"10+")+" años",1)])])]),b("div",ce,[b("div",ve,[b("div",pe,y((null===(N=Qe.value)||void 0===N?void 0:N.completedSessions)||120)+"+",1),l[10]||(l[10]=b("div",{class:"text-[10px] font-bold text-blue-600/70 uppercase"},"Consultas",-1))]),l[11]||(l[11]=b("div",{class:"p-4 bg-blue-50 rounded-2xl text-center"},[b("div",{class:"text-2xl font-bold text-blue-700"},"98%"),b("div",{class:"text-[10px] font-bold text-blue-600/70 uppercase"},"Éxito")],-1))])]),b("section",be,[b("div",xe,[b("div",ge,[b("div",me,[b("div",fe,[m($,{name:"bi-calendar-check"})]),l[12]||(l[12]=b("div",null,[b("h2",{class:"text-xl font-bold text-slate-800"},"Agenda de Citas"),b("p",{class:"text-slate-400 text-sm font-medium"},"Selecciona un horario disponible")],-1))]),Ge.value?(p(),v("div",he,[m($,{class:"animate-bounce",name:"bi-calendar",scale:"1.4"}),b("span",ye,"Tiene una cita agendada para el "+y(Ke.value),1)])):x("",!0)]),b("div",we,[at(null===(S=Qe.value)||void 0===S?void 0:S.specialty)?(p(),v("div",ke,[(p(!0),v(U,null,B(Le.value,(e,t)=>(p(),v("div",{key:t,class:"flex-shrink-0 w-48 space-y-4"},[b("div",Ue,y(t),1),b("div",Be,[(p(!0),v(U,null,B(e,(e,a)=>(p(),v("button",{key:a,onClick:a=>Xe(t,e.time),disabled:e.isAvailable||null!=e.takenBy&&e.takenBy!==k(n)().getUserUid,class:C(["w-full py-3 px-2 rounded-2xl text-sm font-bold transition-all duration-300 transform active:scale-95 flex flex-col items-center gap-1",e.isAvailable?"bg-slate-50 text-slate-300 border border-slate-100 cursor-not-allowed":"",e.isAvailable||null!=e.takenBy?"":"bg-white text-slate-700 border-2 border-slate-100 hover:border-blue-500 hover:text-blue-600",e.takenBy!==k(n)().getUserUid||e.takenAt?"":"bg-blue-600 text-white border-blue-600 shadow-lg scale-[1.02]",e.takenBy===k(n)().getUserUid&&e.takenAt?"bg-green-500 text-white border-green-500 shadow-lg":"",null!=e.takenBy&&e.takenBy!==k(n)().getUserUid?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":""])},[h(y(e.time)+" ",1),b("span",_e,[e.isAvailable||null!=e.takenBy?e.takenBy===k(n)().getUserUid?(p(),v(U,{key:1},[h("Seleccionado")],64)):null!=e.takenBy?(p(),v(U,{key:2},[h("Ocupado")],64)):(p(),v(U,{key:3},[h("Indisponible")],64)):(p(),v(U,{key:0},[h("Disponible")],64))])],10,Ce))),128))])]))),128))])):(p(),v("div",Ae,[m($,{name:"ri-user-smile-line",scale:"3",class:"text-slate-300 mb-4"}),l[13]||(l[13]=b("h3",{class:"text-lg font-bold text-slate-500"},"Ha agotado sus citas gratuitas para esta categoria ",-1)),l[14]||(l[14]=b("p",{class:"text-slate-400 max-w-xs mx-auto text-sm mt-2"},"Para poder continuar con una cita le recomendamos contratar al experto profesional.",-1)),b("button",{onClick:st,class:"mt-4 px-6 py-2 bg-blue-600 text-white font-bold rounded-2xl hover:bg-blue-700"},"Contratar")]))]),m(w,{"enter-active-class":"animate__animated animate__fadeInUp","leave-active-class":"animate__animated animate__fadeOutDown"},{default:f(()=>[Re.value?(p(),v("div",Ee,[b("div",je,[b("div",De,[m($,{name:"bi-calendar-check",scale:"1.2"})]),b("div",null,[l[15]||(l[15]=b("p",{class:"text-white/60 text-xs font-bold uppercase tracking-widest"},"Cita Seleccionada",-1)),b("h4",Ne,y(Re.value),1)])]),b("button",{onClick:Ze,disabled:Ve.value,class:"w-full md:w-auto px-10 py-4 bg-white text-blue-700 hover:bg-blue-50 font-extrabold rounded-2xl shadow-xl transition-all flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50"},[b("span",null,y(Ve.value?"Procesando...":"Confirmar Cita Ahora"),1),Ve.value?x("",!0):(p(),_($,{key:0,name:"hi-paper-airplane"}))],8,Se)])):x("",!0)]),_:1})])])])])):(p(),v("div",H,[...l[0]||(l[0]=[g('<div class="grid grid-cols-1 lg:grid-cols-12 gap-8" data-v-49004d2c><div class="lg:col-span-4 bg-white rounded-3xl p-8 shadow-sm h-96" data-v-49004d2c></div><div class="lg:col-span-8 space-y-6" data-v-49004d2c><div class="bg-white rounded-3xl p-8 shadow-sm h-48" data-v-49004d2c></div><div class="bg-white rounded-3xl p-8 shadow-sm h-96" data-v-49004d2c></div></div></div>',1)])]))]),a.value?(p(),v("div",$e,[b("div",Fe,[l[16]||(l[16]=b("div",{class:"w-20 h-20 border-4 border-white/20 border-t-white rounded-full animate-spin"},null,-1)),b("div",Ie,[m($,{name:"hi-paper-airplane",class:"text-white animate-pulse",scale:"1.5"})])]),b("p",Me,y(M.value),1)])):x("",!0)])}}}),[["__scopeId","data-v-49004d2c"]]))}}});
