import{a as de,k as w,Z as M,l as ue,j as pe,r as fe,b as i,o as n,n as _,f as p,q as Q,e,Y as Z,t as g,g as F,B as ae,L as b,F as j,x as z,W as K,w as se,p as q,z as me,$ as oe,J as k,K as le,V as O,a0 as G,a1 as W,G as Ce,E as ke,H as Fe,a2 as ne,m as De,_ as Ee,a3 as re,v as $e,M as Ae}from"./index-t3-Kmq9U.js";import{G as ie}from"./GenericModal-B5qRZzmE.js";import{e as ce}from"./index-DfBlkqaH.js";import{B as Ue}from"./index-D8R8Z3oe.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ne={class:"w-full animate__animated animate__fadeIn animate__faster font-sans text-slate-900"},Se={class:"flex flex-col md:flex-row md:items-center gap-5"},Le={class:"flex-1 grid grid-cols-1 lg:grid-cols-3 gap-4"},Be={class:"flex flex-col"},Re={class:"text-base font-semibold text-slate-800"},Te={class:"text-sm text-blue-600 font-medium"},Me={class:"flex flex-col border-slate-100 lg:border-l lg:pl-6"},je={class:"flex items-center gap-2 text-slate-700 text-sm"},ze={class:"flex items-center gap-2 text-slate-700 text-sm font-medium mt-1"},Pe={class:"flex flex-col border-slate-100 lg:border-l lg:pl-6 justify-center"},Ve={key:0,class:"inline-flex items-center gap-1.5 py-1 px-3 rounded-full bg-emerald-50 text-emerald-600 text-xs font-bold w-fit"},Oe={key:1,class:"inline-flex items-center gap-1.5 py-1 px-3 rounded-full bg-red-50 text-red-600 text-xs font-bold w-fit"},qe={key:2,class:"inline-flex items-center gap-1.5 py-1 px-3 rounded-full bg-blue-50 text-blue-600 text-xs font-bold w-fit"},Xe={key:3,class:"mt-2 flex items-center gap-1"},He={class:"hidden md:flex items-center justify-center pr-2"},Ge={class:"w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center group-hover:bg-blue-600 group-hover:text-white transition-colors"},Je={key:1,class:"animate__animated animate__fadeIn animate__faster"},Ye={class:"flex items-center justify-between mb-6 pb-4 border-b border-slate-100"},Ze={class:"flex gap-3"},Ke={key:0,class:"px-4 py-1.5 rounded-lg bg-red-100 text-red-700 text-xs font-bold"},We={key:1,class:"px-4 py-1.5 rounded-lg bg-green-100 text-green-700 text-xs font-bold"},Qe={class:"grid grid-cols-1 xl:grid-cols-12 gap-6"},et={class:"xl:col-span-8 space-y-6"},tt={class:"bg-gradient-to-r from-slate-900 to-slate-800 rounded-2xl p-8 text-white shadow-lg relative overflow-hidden"},at={class:"relative z-10"},st={class:"text-blue-400 font-bold text-sm tracking-widest uppercase mb-2"},ot={class:"text-3xl font-bold mb-4"},lt={class:"flex flex-wrap gap-6 text-slate-300"},nt={class:"flex items-center gap-2"},rt={class:"flex items-center gap-2"},it={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ct={class:"bg-white border border-slate-100 p-6 rounded-2xl"},dt={class:"space-y-4"},ut={class:"flex justify-between items-center py-2 border-b border-slate-50"},pt={class:"font-semibold text-slate-800"},ft={class:"flex justify-between items-center py-2 border-b border-slate-50"},mt={class:"font-mono text-sm bg-slate-100 px-2 py-1 rounded text-slate-700"},gt={class:"flex flex-col gap-2 pt-2"},xt={key:0,class:"text-yellow-600 font-medium italic"},bt={class:"bg-white border border-slate-100 p-6 rounded-2xl"},vt={class:"space-y-4"},yt={key:0,class:"bg-slate-50 p-4 rounded-xl"},ht={key:0,class:"flex gap-1"},_t={key:1,class:"text-sm p-4 bg-emerald-50 rounded-xl border border-emerald-100"},wt={class:"flex items-center gap-2 text-emerald-700 font-bold mb-1"},Ct={class:"text-emerald-600 text-xs"},kt={key:2,class:"text-sm p-4 bg-red-50 rounded-xl border border-red-100"},Ft={class:"flex items-center gap-2 text-red-700 font-bold mb-1"},Dt={class:"text-red-800 italic mt-1 font-medium text-xs"},Et={class:"xl:col-span-4 space-y-6"},$t={key:0,class:"bg-white border border-slate-200 p-6 rounded-2xl shadow-sm"},At={class:"flex flex-col gap-3"},Ut={class:"bg-slate-50 p-6 rounded-2xl border border-slate-100 text-slate-500"},It={class:"flex items-start gap-3 text-xs leading-relaxed"},Nt={key:0,class:"mt-4 p-3 bg-blue-100/50 rounded-lg text-blue-700 text-[11px] font-medium uppercase"},St={class:"p-2"},Lt={class:"space-y-3"},Bt={class:"grid grid-cols-1 gap-2"},Rt=["onClick"],Tt={class:"font-bold"},Mt={class:"flex gap-0.5"},jt={key:2,class:"fixed inset-0 z-[110] flex items-center justify-center bg-slate-900/40 backdrop-blur-sm"},zt={class:"bg-white p-8 rounded-2xl shadow-2xl flex flex-col items-center gap-4"},Pt={class:"font-bold text-slate-800 tracking-tight"},Vt=de({__name:"CardInfo",props:{data:{type:Object,required:!0},index:{type:Number}},setup(ee){const N=w(!1),S=w(!1),L=w(5),C=w(""),U=w([{specialty:"ImportaciÃ³n y ExportaciÃ³n",color:{light:"#E6F3FF",strong:"#0066CC"},icon:"fa-truck-moving",description:"Facilitamos el intercambio de bienes y servicios a nivel internacional con normativas seguras."},{specialty:"MÃ©dico",color:{light:"#E6F7FF",strong:"#0099CC"},icon:"gi-stethoscope",description:"Profesionales de la salud comprometidos en atender tus necesidades mÃ©dicas de forma personalizada."},{specialty:"Contador",color:{light:"#E6FFE6",strong:"#008000"},icon:"bi-calculator-fill",description:"Expertos en contabilidad para gestionar tus finanzas de forma precisa y confiable."},{specialty:"Arquitecto",color:{light:"#F0E6FF",strong:"#6600CC"},icon:"md-architecture-sharp",description:"DiseÃ±o y planificaciÃ³n de espacios con profesionalismo y creatividad."},{specialty:"Servicios Web",color:{light:"#E6F9FF",strong:"#00BFFF"},icon:"md-web",description:"Desarrollo de soluciones digitales a medida para potenciar tu presencia online."},{specialty:"Publicidad",color:{light:"#FFF0E6",strong:"#FF6600"},icon:"ri-newspaper-fill",description:"Estrategias creativas para difundir y potenciar la imagen de tu marca."},{specialty:"Traductores",color:{light:"#FFF8E6",strong:"#FFD700"},icon:"hi-solid-translate",description:"Especialistas en comunicaciÃ³n multilingÃ¼e para romper barreras idiomÃ¡ticas."},{specialty:"Peritaje",color:{light:"#F0E6FF",strong:"#800080"},icon:"gi-sherlock-holmes",description:"Evaluaciones tÃ©cnicas y profesionales con rigor y precisiÃ³n."},{specialty:"IngenierÃ­a en ComputaciÃ³n",color:{light:"#E6FFFA",strong:"#00CED1"},icon:"md-computer-twotone",description:"InnovaciÃ³n tecnolÃ³gica y desarrollo de sistemas a la vanguardia."},{specialty:"GestorÃ­a en TrÃ¡mites",color:{light:"#E6E6FF",strong:"#4B0082"},icon:"ri-newspaper-fill",description:"Optimiza tus gestiones administrativas con asesorÃ­as especializadas."},{specialty:"Marketing",color:{light:"#FFE6F0",strong:"#FF1493"},icon:"ri-marketing-strategy-fill",description:"Conecta con tu audiencia a travÃ©s de estrategias innovadoras y efectivas."},{specialty:"Abogado",color:{light:"#F5E6D3",strong:"#8B4513"},icon:"fa-balance-scale",description:"Conecta con un abogado especializado para recibir asesorÃ­a legal directa y resolver tus asuntos jurÃ­dicos."},{specialty:"PsicÃ³logo/a",color:{light:"#E6E6FF",strong:"#6A5ACD"},icon:"ri-psychotherapy-fill",description:"AsesorÃ­a psicolÃ³gica para resolver tus dudas y resolver tus problemas."},{specialty:"Maestro",color:{light:"#F0FFF0",strong:"#2E8B57"},icon:"gi-teacher",description:"AsesorÃ­a educativa para resolver tus dudas y resolver tus problemas."},{specialty:"Chef",color:{light:"#FFE6E6",strong:"#FF4500"},icon:"gi-chef-toque"}]),u=w(!1),D=w(""),X=s=>{if(t.data.isCanceled)return"#fff0f0";if(t.data.isFinished)return"#f0fff0";if(!t.data.isFinished&&!t.data.isCanceled)return"#f0fbff";const a=U.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.color.light:"#E6E6E6"},B=s=>{if(t.data.isCanceled)return"#ff8080";if(t.data.isFinished)return"#00966A";const a=U.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.color.strong:"#E6E6E6"},P=s=>{const a=U.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.icon:""},R=w(!0),t=ee,J=s=>{const a=["domingo","lunes","martes","miercoles","jueves","viernes","sabado"],o=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.findIndex(f=>o.includes(f))},I=M(()=>{var m;if(t.data.appointmentDate)return new Date(t.data.appointmentDate.seconds*1e3);if(!((m=t.data)!=null&&m.createdAt))return null;const s=new Date(t.data.createdAt.seconds*1e3),a=s.getDay(),o=t.data.DayName||t.data.dayName||"",f=J(o);if(f===-1)return s;let h=f-a;h<0&&(h+=7);const c=new Date(s);return c.setDate(s.getDate()+h),c}),d=M(()=>I.value?I.value.toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible"),l=M(()=>t.data.expertSchedule.time),v=M(()=>{var s;return((s=I.value)==null?void 0:s.toLocaleDateString("es-MX",{weekday:"long"}))||t.data.DayName}),r=w("card");ue(()=>{ce.init({blockHeadless:!0,publicKey:"8uRc3wp2ZXACkO_Eb"})});const y=async s=>{var a;try{u.value=!0,D.value="Enviando correo...",ce.send("service_q9e8lj2","template_lv5dfds",{headerTitle:"ConsultaExperto.com",greeting:"Se ha cancelado su cita",userName:t.data.userName,headerDescription:"ConfirmaciÃ³n de cancelaciÃ³n de cita",section1Icon:"ðŸ‘¤",section1Title:"InformaciÃ³n del usuario",section1TitleColor:"#007aff",section1Item1Label:"Nombre:",section1Item1Value:t.data.userName,section1Item2Label:"Servicio:",section1Item2Value:t.data.expertSpecialty,section2Icon:"ðŸ“…",section2Title:"Cita cancelada",section2TitleColor:"#ff3b30",section2Subtitle1:"Cita programada para",section2Value1:"â€¢ ".concat((a=I.value)==null?void 0:a.toLocaleString("es-MX",{dateStyle:"full"})," a las ").concat(l.value,"hrs"),section2Subtitle2:"Cancelada el",section2Value2:s.toDate().toLocaleString("es-MX",{dateStyle:"full",timeStyle:"long"}),section2HighlightLabel:"Cancelada por:",section2HighlightText:"".concat(b().getUserName,",  con motivo: ").concat(C.value||"Motivo no proporcionado"),section3Icon:"ðŸ©º",section3Title:"Datos del experto",section3TitleColor:"#8e8e93",section3Item1Label:"Nombre",section3Item1Value:t.data.expertName,section3Item2Label:"CÃ©dula",section3Item2Value:t.data.expertProfessionalId,footerYear:new Date().getFullYear(),footerLinkUrl:"https://consultaexperto.com",footerLinkText:"consultaexperto.com",footerRightsText:"Todos los derechos reservados.",email:b().getUserEmail}),u.value=!1}catch(o){console.log(o),u.value=!1}},E=()=>{if(R.value){R.value=!1;return}r.value=r.value==="card"?"modal":"card"},x=pe(),$=s=>s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),H=async()=>{try{u.value=!0,D.value="Cancelando cita...";const s=O.now(),a=k(x,"experts/".concat(t.data.expertUid)),o=await le(a);if(!o.exists())return console.log("Could not find the expert document"),u.value=!1,!1;const f=o.data().schedule;console.log("Expert Data: ".concat(JSON.stringify(f))),console.log("Formatted Day: ".concat($(v.value)));const h=Object.keys(f).find(A=>$(A)==$(v.value));console.log("Match Day: ".concat(h));const c=f[h];console.log("Expert Schedule Slot: ".concat(c));const m=c==null?void 0:c.find(A=>A.takenBy==t.data.userUid);if(console.log("Slot Match: ".concat(m)),!m)return console.log("Could not find the expert slot for this appointment"),u.value=!1,!1;if(m.takenBy=null,m.takenAt=null,!t.data.docRef)return console.log("Couldn't find docRef for this document "),u.value=!1,!1;const T=oe(x);T.update(a,{schedule:f}),console.log("Document doc Ref: ".concat(t.data.docRef)),T.update(k(x,"schedules/".concat(t.data.docId)),{isCanceled:!0,cancelationReason:C.value,canceledAt:s,canceledByUid:b().getUserUid||"",canceledByName:b().getUserName||""});const V="".concat(t.data.expertUid,"_").concat(h,"_").concat(m.time),Y=k(x,"bookings",V);return T.delete(Y),console.log("Guardian deleted: ".concat(V)),await T.commit(),await y(s),u.value=!1,console.log("Appointment canceled successfully"),!0}catch(s){return console.error("Error in batch function:",s),u.value=!1,!1}},ge=async()=>{try{u.value=!0,D.value="Finalizando cita...";const s=oe(x),a=k(x,"experts/".concat(t.data.expertUid)),o=await le(a);if(!o.exists())return console.log("Could not find the expert document"),u.value=!1,!1;const f=o.data().schedule;console.log("Expert Data: ".concat(JSON.stringify(f))),console.log("Formatted Day: ".concat($(v.value)));const h=Object.keys(f).find(A=>$(A)==$(v.value));console.log("Match Day: ".concat(h));const c=f[h];console.log("Expert Schedule Slot: ".concat(c));const m=c==null?void 0:c.find(A=>A.takenBy==t.data.userUid);if(console.log("Slot Match: ".concat(m)),!m)return console.log("Could not find the expert slot for this appointment"),u.value=!1,!1;m.takenBy=null,m.takenAt=null,s.update(a,{schedule:f}),s.update(k(x,"schedules/".concat(t.data.docId)),{isFinished:!0,finishedAt:O.now(),finishedByExpert:!0,finishedByUid:b().getUserUid||"UID no disponible",finishedByName:b().getUserName||"Nombre no disponible"});const T=k(x,"users/".concat(t.data.userUid));s.update(T,{["categoryConsultations.".concat(t.data.expertSpecialty)]:{takenAt:O.now(),hasFreeConsult:!1}});const V="".concat(t.data.expertUid,"_").concat(h,"_").concat(m.time),Y=k(x,"bookings",V);s.delete(Y),console.log("Guardian deleted: ".concat(V)),await s.commit(),u.value=!1;try{te()}catch(A){console.error("Error presenting rating alert",A)}}catch(s){console.error("Error finalizando la cita:",s),u.value=!1}},xe=async()=>{try{u.value=!0,D.value="Confirmando cita...";const s=k(x,"".concat(t.data.docRef.path));await G(s,{acceptedByExpert:!0,acceptedAt:O.now(),appointmentLink:"https://meet.greenhost.net/".concat(t.data.expertName).concat(t.data.userName).concat(t.data.createdAt.toDate().getTime())}),u.value=!1}catch(s){u.value=!1,console.log("Error in confirming appointment function: ".concat(s))}},be=async()=>{if(t.data.isFinished){console.log("Schedule is already finished");return}if(t.data.isCanceled){console.log("Schedule is already canceled");return}try{u.value=!0,D.value="Preparando para entrar al link...";const s=k(x,"".concat(t.data.docRef.path));await G(s,{isOpenedLinkByExpert:!0,openedLinkAt:O.now(),consultInCourse:!0}),u.value=!1,Ue.open({url:t.data.appointmentLink})}catch(s){u.value=!1,console.log("Error in confirming appointment function: ".concat(s))}},ve=()=>{N.value=!0},ye=async()=>{C.value.trim()&&(N.value=!1,await H())},te=()=>{S.value=!0},he=async()=>{try{await _e(L.value),await we(L.value)}catch(s){console.error("Error updating rating:",s)}S.value=!1},_e=async s=>{if(s<1||s>5)return!1;if(!b().getUserUid||!b().getUserName)return console.log("No user data available"),!1;console.log("Is user Expert: ".concat(b().getIsExpert)),console.log("User UID: ".concat(b().getUserUid)),console.log("User Name: ".concat(b().getUserName));const a=b().getIsExpert?"users":"experts",o=a==="users"?t.data.userUid:t.data.expertUid;let f;try{f=k(x,"".concat(a,"/").concat(o)),await G(f,{["rating.stars.".concat(s)]:W(1),"rating.total":W(s),"rating.count":W(1)}),console.log("".concat(a," stars updated successfully to user with uid: ").concat(o))}catch(h){console.log("Error trying to update ".concat(a," stars : ").concat(h))}},we=async s=>{if(s<1||s>5)return!1;if(!b().getUserUid||!b().getUserName)return console.log("No user data available"),!1;const a=b().getIsExpert?"Expert":"User";let o;try{o=k(x,"".concat(t.data.docRef.path)),await G(o,{["ratedBy".concat(a)]:!0,["consultRatingBy".concat(a)]:s}),console.log("".concat(a," consult rating updated successfully to user with uid: ").concat(b().getUserUid))}catch(f){console.log("Error trying to update ".concat(a," consult rating : ").concat(f))}};return(s,a)=>{var f,h;const o=fe("v-icon");return n(),i("section",Ne,[r.value==="card"?(n(),i("article",{key:0,onClick:E,class:Q([{"animate__animated animate__fadeInUp animate__faster":R.value&&t.index===0||!R.value},"group relative bg-white border border-slate-200 rounded-xl p-5 hover:border-blue-400 hover:shadow-xl hover:shadow-blue-500/5 transition-all duration-300 cursor-pointer overflow-hidden"])},[e("div",{class:"absolute left-0 top-0 h-full w-1.5",style:Z({backgroundColor:B(t.data.expertSpecialty)})},null,4),e("div",Se,[e("div",{class:"flex-shrink-0 w-14 h-14 rounded-xl flex items-center justify-center transition-transform group-hover:scale-110",style:Z({backgroundColor:X(t.data.expertSpecialty)})},[p(o,{name:P(t.data.expertSpecialty),scale:"1.5",style:Z({color:B(t.data.expertSpecialty)})},null,8,["name","style"])],4),e("div",Le,[e("div",Be,[a[3]||(a[3]=e("h4",{class:"text-xs font-bold uppercase tracking-wider text-slate-400 mb-1"},"Paciente / Usuario",-1)),e("span",Re,g(t.data.userName),1),e("span",Te,g(t.data.expertSpecialty),1)]),e("div",Me,[a[4]||(a[4]=e("h4",{class:"text-xs font-bold uppercase tracking-wider text-slate-400 mb-1"},"ProgramaciÃ³n",-1)),e("div",je,[p(o,{name:"fa-calendar-alt",scale:"0.7"}),e("span",null,g(d.value),1)]),e("div",ze,[p(o,{name:"fa-clock",scale:"0.7"}),e("span",null,g(l.value)+" hrs",1)])]),e("div",Pe,[t.data.isFinished&&!t.data.isCanceled?(n(),i("div",Ve,[...a[5]||(a[5]=[e("span",{class:"relative flex h-2 w-2"},[e("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e("span",{class:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})],-1),F(" FINALIZADA ",-1)])])):t.data.isCanceled?(n(),i("div",Oe,[p(o,{name:"fa-times-circle",scale:"0.6"}),a[6]||(a[6]=F(" CANCELADA ",-1))])):(n(),i("div",qe,[p(o,{name:"fa-calendar-check",scale:"0.6"}),a[7]||(a[7]=F(" PROGRAMADA ",-1))])),ae(b)().getIsExpert&&t.data.isFinished?(n(),i("div",Xe,[(n(!0),i(j,null,z(t.data.consultRatingByExpert,(c,m)=>(n(),K(o,{key:m,name:"bi-star-fill",class:"text-yellow-400",scale:"0.6"}))),128))])):_("",!0)])]),e("div",He,[e("div",Ge,[p(o,{name:"fa-chevron-right",scale:"0.8"})])])])],2)):_("",!0),r.value==="modal"?(n(),i("div",Je,[e("nav",Ye,[e("button",{onClick:E,class:"flex items-center gap-2 text-slate-500 hover:text-blue-600 transition-colors font-medium"},[p(o,{name:"fa-chevron-left",scale:"0.8"}),a[8]||(a[8]=e("span",null,"Volver al listado",-1))]),e("div",Ze,[t.data.isCanceled?(n(),i("span",Ke,"CANCELADA")):_("",!0),t.data.isFinished?(n(),i("span",We,"COMPLETADA")):_("",!0)])]),e("div",Qe,[e("div",et,[e("header",tt,[p(o,{name:"fa-calendar-check",class:"absolute right-[-20px] top-[-20px] opacity-10",scale:"10"}),e("div",at,[e("p",st,g(t.data.expertSpecialty),1),e("h2",ot,"Consulta con "+g(t.data.userName),1),e("div",lt,[e("div",nt,[p(o,{name:"bi-calendar-event-fill",class:"text-blue-400"}),e("span",null,g(d.value),1)]),e("div",rt,[p(o,{name:"fa-clock",class:"text-blue-400"}),e("span",null,g(l.value)+" hrs",1)])])])]),e("div",it,[e("section",ct,[a[13]||(a[13]=e("h3",{class:"text-slate-400 text-xs font-bold uppercase mb-4 tracking-widest"},"InformaciÃ³n de la Cita",-1)),e("div",dt,[e("div",ut,[a[9]||(a[9]=e("span",{class:"text-slate-500"},"Agendado por:",-1)),e("span",pt,g(t.data.userName),1)]),e("div",ft,[a[10]||(a[10]=e("span",{class:"text-slate-500"},"ID Profesional:",-1)),e("span",mt,g(t.data.expertProfessionalId),1)]),e("div",gt,[a[12]||(a[12]=e("span",{class:"text-slate-500"},"Enlace de la sesiÃ³n:",-1)),t.data.appointmentLink=="En proceso..."?(n(),i("div",xt," En proceso...")):t.data.acceptedByExpert?(n(),i("button",{key:1,onClick:be,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all shadow-lg shadow-blue-200 flex items-center justify-center gap-2"},[p(o,{name:"co-link"}),a[11]||(a[11]=F(" Comenzar Cita ",-1))])):_("",!0)])])]),e("section",bt,[a[16]||(a[16]=e("h3",{class:"text-slate-400 text-xs font-bold uppercase mb-4 tracking-widest"},"Estado y CalificaciÃ³n",-1)),e("div",vt,[ae(b)().getIsExpert&&!t.data.isCanceled&&t.data.isFinished?(n(),i("div",yt,[a[15]||(a[15]=e("p",{class:"text-xs text-slate-500 mb-2 uppercase font-bold"},"Tu calificaciÃ³n del paciente:",-1)),t.data.ratedByExpert?(n(),i("div",ht,[(n(!0),i(j,null,z(t.data.consultRatingByExpert,(c,m)=>(n(),K(o,{key:m,name:"bi-star-fill",class:"text-yellow-500"}))),128))])):(n(),i("button",{key:1,onClick:te,class:"text-sm text-blue-600 font-bold hover:underline flex items-center gap-1"},[a[14]||(a[14]=F(" Calificar ahora ",-1)),p(o,{name:"bi-star-fill",scale:"0.7"})]))])):_("",!0),t.data.isFinished?(n(),i("div",_t,[e("div",wt,[p(o,{name:"fa-user-check"}),F(" Finalizada por "+g(t.data.finishedByName||"Sistema"),1)]),e("p",Ct,g((f=t.data.finishedAt)==null?void 0:f.toDate().toLocaleString()),1)])):_("",!0),t.data.isCanceled?(n(),i("div",kt,[e("div",Ft,[p(o,{name:"fa-user-times"}),F(" Cancelado por "+g(t.data.canceledByName),1)]),e("p",Dt,'"'+g(t.data.cancelationReason)+'"',1)])):_("",!0)])])])]),e("aside",Et,[!t.data.isFinished&&!t.data.isCanceled?(n(),i("div",$t,[a[20]||(a[20]=e("h3",{class:"text-slate-800 font-bold mb-4"},"Acciones de GestiÃ³n",-1)),e("div",At,[t.data.acceptedByExpert?_("",!0):(n(),i("button",{key:0,onClick:xe,class:"w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2"},[p(o,{name:"bi-calendar-check"}),a[17]||(a[17]=F(" Confirmar Cita ",-1))])),t.data.acceptedByExpert&&!t.data.isFinished?(n(),i("button",{key:1,onClick:ge,class:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2"},[p(o,{name:"bi-calendar-check"}),a[18]||(a[18]=F(" Finalizar Cita ",-1))])):_("",!0),e("button",{onClick:ve,class:"w-full bg-white border-2 border-rose-100 text-rose-500 hover:bg-rose-50 font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2"},[p(o,{name:"gi-cancel"}),a[19]||(a[19]=F(" Cancelar Cita ",-1))])])])):_("",!0),e("div",Ut,[a[21]||(a[21]=e("h4",{class:"text-xs font-bold uppercase mb-3 tracking-widest"},"Registro de Actividad",-1)),e("div",It,[p(o,{name:"fa-info-circle",class:"mt-0.5"}),e("p",null,"Creada el "+g((h=t.data.createdAt)==null?void 0:h.toDate().toLocaleString("es-MX",{dateStyle:"long",timeStyle:"short"})),1)]),t.data.acceptedByExpert?_("",!0):(n(),i("div",Nt," â“˜ El enlace se generarÃ¡ una vez que aceptes la cita. "))])])])])):_("",!0),p(ie,{show:N.value,"onUpdate:show":a[1]||(a[1]=c=>N.value=c),title:"Cancelar Cita",confirmText:"Confirmar CancelaciÃ³n",onConfirm:ye},{default:se(()=>[e("div",St,[a[22]||(a[22]=e("p",{class:"text-sm text-slate-500 mb-3 font-medium"},"Por favor, indica el motivo de la cancelaciÃ³n:",-1)),q(e("textarea",{"onUpdate:modelValue":a[0]||(a[0]=c=>C.value=c),class:"w-full p-4 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all",rows:"4",placeholder:"Escribe aquÃ­ el motivo..."},null,512),[[me,C.value]])])]),_:1},8,["show"]),p(ie,{show:S.value,"onUpdate:show":a[2]||(a[2]=c=>S.value=c),title:"Calificar servicio",confirmText:"Enviar CalificaciÃ³n",onConfirm:he},{default:se(()=>[e("div",Lt,[a[23]||(a[23]=e("p",{class:"text-sm text-slate-500 mb-2"},"Selecciona la calificaciÃ³n para el usuario:",-1)),e("div",Bt,[(n(),i(j,null,z([5,4,3,2,1],c=>e("button",{key:c,onClick:m=>L.value=c,class:Q(["flex items-center justify-between p-4 rounded-xl border transition-all",L.value===c?"bg-blue-600 border-blue-600 text-white shadow-lg":"bg-white border-slate-200 text-slate-600 hover:bg-slate-50"])},[e("span",Tt,g(c)+" Estrellas",1),e("div",Mt,[(n(!0),i(j,null,z(c,m=>(n(),K(o,{key:m,name:"bi-star-fill",scale:L.value===c?"0.8":"0.7"},null,8,["scale"]))),128))])],10,Rt)),64))])])]),_:1},8,["show"]),u.value?(n(),i("div",jt,[e("div",zt,[a[24]||(a[24]=e("div",{class:"w-12 h-12 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin"},null,-1)),e("p",Pt,g(D.value),1)])])):_("",!0)])}}}),Ot=Ie(Vt,[["__scopeId","data-v-77be83bc"]]),qt={class:"web-page min-h-screen bg-gray-50"},Xt={class:"web-content p-4 space-y-4 mt-28"},Ht={class:"relative w-full"},Gt={class:"flex gap-2"},Jt={class:"flex p-1 bg-gray-100 rounded-xl"},Yt=["onClick"],Zt={class:"space-y-4"},Kt={class:"flex items-center gap-2 justify-center py-2 text-gray-500 text-sm font-bold bg-gray-50 rounded-lg"},Wt={class:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"},Qt={key:0,class:"flex justify-center items-center py-12 bg-white rounded-2xl border border-dashed border-gray-200 text-gray-400 font-poppins"},ea={class:"space-y-3"},na=de({__name:"ExpertView",setup(ee){const N=b(),S=w([]),L=w(!1),C=w("Proximas"),U=w(""),u=w("creation"),D=w("Recientes"),X=pe();let B=null,P=null;const R=d=>{const l=["domingo","lunes","martes","miercoles","jueves","viernes","sabado"];if(!d)return-1;const v=d.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return l.findIndex(r=>v.includes(r))},t=d=>{if(d.appointmentDate)return new Date(d.appointmentDate.seconds*1e3);if(!d.createdAt)return null;const l=new Date(d.createdAt.seconds*1e3),v=l.getDay(),r=d.DayName||d.dayName||"",y=R(r);if(y===-1)return l;let E=y-v;E<0&&(E+=7);const x=new Date(l);return x.setDate(l.getDate()+E),x},J=M(()=>{let d=[...S.value];if(C.value==="Proximas"?d=d.filter(l=>!l.isFinished&&!l.isCanceled):C.value==="Finalizadas"?d=d.filter(l=>l.isFinished):C.value==="Canceladas"&&(d=d.filter(l=>l.isCanceled)),U.value){const l=U.value.toLowerCase().trim();d=d.filter(v=>(v.userName||"").toLowerCase().includes(l)||(v.expertSpecialty||"").toLowerCase().includes(l))}return d.sort((l,v)=>{var E,x,$,H;let r=0,y=0;return u.value==="creation"?(r=((E=l.createdAt)==null?void 0:E.seconds)||0,y=((x=v.createdAt)==null?void 0:x.seconds)||0):(r=(($=t(l))==null?void 0:$.getTime())||0,y=((H=t(v))==null?void 0:H.getTime())||0),D.value==="Recientes"?y-r:r-y}),d}),I=M(()=>J.value);return ue(()=>{const d=Ce(X,"schedules"),l=ke(d,Fe("expertUid","==",N.getUserUid));B=ne(l,r=>{S.value=r.docs.map(y=>({...y.data(),docId:y.id,docRef:y.ref}))});const v=k(X,"experts/".concat(N.getUserUid));P=ne(v,r=>{r.exists()&&Ae().setExpertData(r.data())})}),De(()=>{B&&B(),P&&P()}),(d,l)=>{const v=fe("v-icon");return n(),i("div",qt,[p(Ee,{pageTitle:"Proximas citas"}),e("main",Xt,[e("div",Ht,[p(v,{class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",name:"fa-search"}),q(e("input",{class:"web-search-input w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-2xl outline-none focus:ring-2 focus:ring-blue-100 transition-all font-medium","onUpdate:modelValue":l[0]||(l[0]=r=>U.value=r),placeholder:"Usuario, especialidad o estado..."},null,512),[[me,U.value]])]),e("div",Gt,[q(e("select",{class:"web-select flex-1 p-3 bg-white border border-gray-200 rounded-xl outline-none text-xs font-poppins","onUpdate:modelValue":l[1]||(l[1]=r=>u.value=r)},[...l[3]||(l[3]=[e("option",{value:"creation"},"Fecha de CreaciÃ³n",-1),e("option",{value:"scheduled"},"Fecha Agendada",-1)])],512),[[re,u.value]]),q(e("select",{class:"web-select flex-1 p-3 bg-white border border-gray-200 rounded-xl outline-none text-xs font-poppins","onUpdate:modelValue":l[2]||(l[2]=r=>D.value=r)},[...l[4]||(l[4]=[e("option",{value:"Recientes"},"MÃ¡s recientes",-1),e("option",{value:"Antiguas"},"MÃ¡s antiguas",-1)])],512),[[re,D.value]])]),e("div",Jt,[(n(),i(j,null,z(["Proximas","Finalizadas","Canceladas"],r=>e("button",{class:Q(["flex-1 py-2 text-sm font-bold rounded-lg transition-all",C.value===r?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"]),key:r,onClick:y=>C.value=r},g(r),11,Yt)),64))]),e("div",Zt,[e("div",Kt,[F(g(I.value.length)+" Citas "+g(C.value.toLowerCase())+" ",1),q(e("div",Wt,null,512),[[$e,L.value]])]),I.value.length===0?(n(),i("div",Qt," No se encontraron citas ")):_("",!0),e("div",ea,[(n(!0),i(j,null,z(I.value,(r,y)=>(n(),i("div",{key:r.docId||y},[p(Ot,{data:r,index:y},null,8,["data","index"])]))),128))])])])])}}});export{na as default};
