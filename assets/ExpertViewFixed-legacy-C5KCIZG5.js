System.register(["./index-legacy-h0psoif2.js","./expertUi-legacy-BUHPHiIO.js","./index-legacy-CPnhazDU.js","./stars-legacy-um4h9HOd.js","./hiring-legacy-BQ-09gC7.js","./_plugin-vue_export-helper-legacy-BVIICed7.js"],function(e,t){"use strict";var a,l,s,i,n,r,o,d,u,c,v,p,b,x,g,m,f,h,y,w,k,U,C,B,_,j,E,A,D,N,S,$,F,I,L;return{setters:[e=>{a=e.a,l=e.k,s=e.u,i=e.$,n=e.i,r=e.L,o=e.j,d=e.l,u=e.m,c=e.r,v=e.b,p=e.o,b=e.e,x=e.n,g=e.c,m=e.f,f=e.w,h=e.g,y=e.t,w=e.Y,k=e.q,U=e.F,C=e.v,B=e.x,_=e.W,j=e.J,E=e.G,A=e.a5,D=e.V,N=e.a3},e=>{S=e.u},e=>{$=e.e},e=>{F=e.u},e=>{I=e.u},e=>{L=e._}],execute:function(){var t=document.createElement("style");t.textContent=".scrollbar-hide[data-v-cb52ce31]::-webkit-scrollbar{display:none}.scrollbar-hide[data-v-cb52ce31]{-ms-overflow-style:none;scrollbar-width:none}.bg-white\\/20[data-v-cb52ce31]{background-color:rgba(255,255,255,.2)}.rounded-3xl[data-v-cb52ce31]{border-radius:1.5rem}.transition-all[data-v-cb52ce31]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.3s}\n",document.head.appendChild(t);const M={class:"min-h-screen bg-[#F8FAFC] pb-10 font-manrope"},O={class:"px-4 sm:px-6 lg:px-8 pt-28 mt-5"},V={key:0,class:"animate-pulse space-y-8"},H={key:1,class:"space-y-2"},P={key:0,class:"bg-blue-50 border-l-4 border-blue-600 p-6 rounded-2xl shadow-sm flex flex-col md:flex-row items-center justify-between gap-6"},q={class:"flex items-start gap-4"},T={class:"p-3 bg-blue-100 rounded-xl text-blue-600"},z={class:"text-blue-700 text-sm mt-1"},J={class:"font-bold underline"},R={class:"grid grid-cols-1 lg:grid-cols-12 gap-8 items-start"},Y={class:"lg:col-span-4 space-y-6"},G={class:"rounded-[2.5rem] shadow-xl shadow-slate-200/50 overflow-hidden border border-slate-100 group"},K={class:"p-8 text-center"},W={class:"relative group inline-block mb-6"},X={class:"w-32 h-32 rounded-[2rem] overflow-hidden ring-4 ring-offset-4 ring-blue-500 transition-all group-hover:scale-105"},Z=["src","alt"],Q={class:"text-2xl font-extrabold text-slate-800 tracking-tight"},ee={class:"text-blue-600 font-semibold text-sm mt-1 uppercase tracking-wider"},te={key:0,class:"mt-2 inline-flex items-center px-3 py-1 rounded-full bg-red-50 text-red-600 text-xs font-bold border border-red-100"},ae={class:"mt-6 flex items-center justify-center gap-2 bg-slate-50 rounded-2xl py-3 px-4"},le={class:"flex items-center gap-1"},se={class:"text-xl font-bold text-slate-800"},ie={class:"text-xs text-slate-500 font-medium"},ne={class:"border-t border-slate-100 bg-slate-50/50 p-6 space-y-4"},re={class:"flex items-center justify-between"},oe={class:"text-sm font-semibold text-slate-700"},de={class:"flex items-center justify-between"},ue={class:"text-sm font-semibold text-slate-700"},ce={class:"flex items-center justify-between"},ve={class:"text-sm font-semibold text-slate-700"},pe={class:"flex items-center justify-between flex-col"},be={class:"text-sm font-semibold text-slate-700"},xe={class:"bg-white rounded-[2rem] p-6 shadow-sm border border-slate-100 grid grid-cols-2 gap-4"},ge={class:"p-4 bg-blue-50 rounded-2xl text-center"},me={class:"text-2xl font-bold text-blue-700"},fe={class:"p-4 bg-blue-50 rounded-2xl text-center"},he={class:"text-2xl font-bold text-blue-700"},ye={class:"text-[10px] font-bold text-blue-600/70 uppercase"},we={class:"lg:col-span-8 space-y-8"},ke={class:"bg-white rounded-[2.5rem] shadow-xl shadow-slate-200/50 border border-slate-100 overflow-hidden"},Ue={class:"p-8 pb-0 flex flex-col sm:flex-row sm:items-center justify-between gap-4"},Ce={class:"flex items-center gap-3"},Be={class:"p-2.5 bg-blue-600 rounded-xl text-white shadow-lg shadow-blue-200"},_e={key:0,class:"flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-xl border border-blue-100 ring-1 ring-blue-100"},je={class:"text-xs font-bold"},Ee={class:"ml-2 text-xs font-bold bg-blue-600 p-2 rounded-2xl text-white transition-colors flex items-center gap-1"},Ae={class:"p-4"},De={key:0,class:"flex overflow-x-auto gap-6 pb-2 scrollbar-hide"},Ne={class:"text-center py-2 bg-slate-50 rounded-xl border border-slate-100 text-blue-700 font-bold text-sm"},Se={class:"space-y-3"},$e=["onClick","disabled"],Fe={class:"text-[9px] uppercase tracking-widest opacity-80"},Ie={key:1,class:"text-center py-12 bg-slate-50 rounded-[2rem] border-2 border-dashed border-slate-200"},Le={key:0,class:"bg-gradient-to-r from-blue-700 to-blue-700 p-6 flex flex-col md:flex-row items-center justify-between gap-6"},Me={class:"flex items-center gap-4"},Oe={class:"p-3 bg-white/20 rounded-2xl text-white backdrop-blur-md"},Ve={class:"text-white font-bold text-lg md:text-xl"},He=["disabled"],Pe={key:0,class:"fixed inset-0 z-[100] flex flex-col items-center justify-center bg-blue-900/40 backdrop-blur-sm transition-all"},qe={class:"relative"},Te={class:"absolute inset-0 flex items-center justify-center"},ze={class:"mt-4 text-white font-bold text-lg tracking-wide"};e("default",L(a({__name:"ExpertViewFixed",setup(e){const{calcStarsValue:t}=F(),a=l(!1),L=l(""),Je=s(),Re=l(!1),Ye={Domingo:0,Lunes:1,Martes:2,Miercoles:3,"Miércoles":3,Jueves:4,Viernes:5,Sabado:6,"Sábado":6},Ge=i(()=>{var e;const t=null===(e=rt.value)||void 0===e?void 0:e.schedule,a={};return["Lunes","Martes","Miercoles","Jueves","Viernes","Sábado"].forEach(e=>{null!=t&&t[e]&&(a[e]=t[e])}),a}),Ke=n(),We=r(),Xe=l(null),Ze=(e,t)=>{const a=Ye[e];if(void 0===a)throw new Error("Día inválido");const[l,s]=t.trim().split(":").map(Number),i=new Date,n=a-i.getDay(),r=new Date(i);return r.setDate(i.getDate()+n),r.setHours(l,s,0,0),r<=i&&r.setDate(r.getDate()+7),r},Qe=e=>{const t=new Date;return e.getTime()-t.getTime()>=864e5},et=(e,t)=>{if(lt.value)return void Je.warning("No puede agendar horarios si ya tiene citas agendadas");if(!We.getIsAuth&&(Ke.push("/login"),1))return;const a=Ge.value[e];if(!a)return;const l=a.find(e=>e.time===t);if(!l)return;if(l.isAvailable)return void Je.warning(`El horario de las ${l.time} no está disponible`);if(null!=l.takenBy&&l.takenBy!=r().getUserUid)return void Je.warning(`El horario de las ${l.time} ya está tomado por otro usuario`);if(l.takenBy==r().getUserUid&&null!=l.takenAt)return void Je.warning(`El horario de las ${l.time} ya está tomado por usted`);let s;try{if(s=Ze(e,l.time),!Qe(s))return void Je.warning("No es posible agendar con menos de 24 horas de anticipación.")}catch(n){return void Je.error("Error al calcular fecha de cita")}const i=Object.values(Ge.value).flat(1).find(e=>e.takenBy==r().getUserUid&&!e.takenAt);if(i&&i!==l&&(i.takenBy=null),l.takenBy==r().getUserUid)l.takenBy=null,Xe.value=null,it.value=null;else{l.takenBy=r().getUserUid,Xe.value=l;const e={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"},t=s.toLocaleDateString("es-ES",e);it.value=t.charAt(0).toUpperCase()+t.slice(1)}},tt=o(),at=async()=>{var e,t,l,s;if(!Xe.value)return void Je.warning("No se ha seleccionado ningún horario");if(null!==(e=rt.value)&&void 0!==e&&e.isSuspended||null!==(t=rt.value)&&void 0!==t&&t.isBanned)return void Je.error("No puede agendar horarios con este experto.");if(lt.value)return void Je.error("Ya tiene una cita agendada.");const i=Object.keys(Ge.value).find(e=>Ge.value[e].includes(Xe.value));if(!i)return;const n=Ze(i,Xe.value.time);if(!Qe(n))return void Je.error("Mínimo 24 horas de anticipación requeridas.");a.value=!0,L.value="Asegurando tu cita...",Re.value=!0;const o=`${null===(l=rt.value)||void 0===l?void 0:l.userUid}_${i}_${Xe.value.time}`,d=j(tt,"bookings",o),u=j(tt,`experts/${null===(s=rt.value)||void 0===s?void 0:s.userUid}`),c=j(E(tt,"schedules"));try{await A(tt,async e=>{var t,a,l,s,o;const v=await e.get(d),p=await e.get(u);if(v.exists())throw new Error("Este horario ya fue reservado.");if(!p.exists())throw new Error("El experto no existe.");const b=(null===(t=p.data())||void 0===t?void 0:t.schedule)||{},x=(b[i]||[]).find(e=>e.time===Xe.value.time);if(!x||x.takenBy&&x.takenBy!==r().getUserUid)throw new Error("El horario ya no está disponible.");x.takenBy=r().getUserUid,x.takenAt=D.now(),e.set(d,{reserverUid:r().getUserUid,createdAt:D.now()}),e.update(u,{schedule:b}),e.set(c,{userName:r().getUserName,userUid:r().getUserUid,expertUid:null===(a=rt.value)||void 0===a?void 0:a.userUid,expertName:null===(l=rt.value)||void 0===l?void 0:l.fullName,expertSchedule:Xe.value,expertSpecialty:null===(s=rt.value)||void 0===s?void 0:s.specialty,expertProfessionalId:null===(o=rt.value)||void 0===o?void 0:o.professionalId,appointmentLink:"",isFinished:!1,dayName:i,appointmentDate:D.fromDate(n),createdAt:D.now(),acceptedByExpert:!1})}),Je.success("¡Cita agendada con éxito!"),setTimeout(()=>Ke.push("/appointments"),1500)}catch(v){Je.error(v.message||"Error al agendar la cita."),Re.value=!1,a.value=!1,Xe.value&&(Xe.value.takenBy=null)}},lt=l(!1),st=l(""),it=l(null),nt=l(!1),rt=l(null);let ot;const dt=async()=>{const e=S().getExpertUid;if(!e)return nt.value=!0,!1;const t=j(tt,`experts/${e}`);ot=N(t,e=>{e.exists()?(rt.value=e.data(),(()=>{var e;const t=null===(e=rt.value)||void 0===e?void 0:e.schedule;if(lt.value=!1,st.value="",t)for(const[a,l]of Object.entries(t)){const e=l.find(e=>e.takenBy==r().getUserUid&&e.takenAt);if(e){lt.value=!0,st.value=`${a} a las ${e.time}`;break}}})(),nt.value=!0):Je.error("No se encontró al experto")})};d(async()=>{await dt(),$.init({blockHeadless:!0,publicKey:"8uRc3wp2ZXACkO_Eb"})}),u(()=>{ot&&ot()});const ut=e=>{if(!e)return!1;const t=r().getUserData;if(null==t||!t.categoryConsultations)return!0;const a=t.categoryConsultations[e];return!a||a.hasFreeConsult},ct=I(),vt=()=>{rt.value&&(ct.setExpertHiringData(rt.value.fullName,rt.value.specialty,rt.value.userUid),Ke.push("/hiring"))};return(e,l)=>{var s,i,n,o,d,u,j,E,A,D,N,S,$,F,I,Je;const Ye=c("v-icon"),Ke=c("RouterLink");return p(),v("div",M,[b("main",O,[nt.value?(p(),v("div",H,[m(w,{"enter-active-class":"animate__animated animate__fadeInDown"},{default:f(()=>{var e,t;return[ut(null===(e=rt.value)||void 0===e?void 0:e.specialty)?x("",!0):(p(),v("div",P,[b("div",q,[b("div",T,[m(Ye,{name:"ri-error-warning-line",scale:"1.5",animation:"ring"})]),b("div",null,[l[3]||(l[3]=b("h4",{class:"text-blue-900 font-bold text-lg"},"Citas gratuitas agotadas",-1)),b("p",z,[l[1]||(l[1]=h(" Has completado tus citas gratuitas en la categoría ",-1)),b("span",J,y(null===(t=rt.value)||void 0===t?void 0:t.specialty),1),l[2]||(l[2]=h(". Contrata al experto para continuar con tu asesoría profesional. ",-1))])])]),b("button",{onClick:vt,class:"w-full md:w-auto px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-2xl shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-2 group"},[l[4]||(l[4]=b("span",null,"Contratar Ahora",-1)),m(Ye,{name:"bi-person-badge",class:"group-hover:translate-x-1 transition-transform"})])]))]}),_:1}),b("div",R,[b("aside",Y,[b("div",G,[b("div",K,[b("div",W,[l[5]||(l[5]=b("div",{class:"absolute z-10 bottom-0 opacity-0 group-hover:animate-fade-up group-hover:opacity-100 min-w-40 left-36 bg-white ring-[1px] ring-blue-500 text-blue-600 flex items-center justify-center rounded-lg p-2"},[b("p",{class:"text-xs font-quicksand"},"Este experto esta verificado por el equipo de Consulta Experto")],-1)),b("div",X,[b("img",{class:"w-full h-full object-cover",src:(null===(s=rt.value)||void 0===s?void 0:s.imgUrl)||"https://ui-avatars.com/api/?name="+(null===(i=rt.value)||void 0===i?void 0:i.fullName)+"&background=0D8ABC&color=fff",alt:null===(n=rt.value)||void 0===n?void 0:n.fullName},null,8,Z)]),m(Ye,{class:"absolute -bottom-2 -right-2 bg-blue-500 text-white w-10 h-10 p-1 rounded-full border-4 border-white shadow-sm",name:"ri-shield-check-fill",scale:"0.7"})]),b("h1",Q,y(null===(o=rt.value)||void 0===o?void 0:o.fullName),1),b("p",ee,y(null===(d=rt.value)||void 0===d?void 0:d.specialty),1),null!==(u=rt.value)&&void 0!==u&&u.isSuspended?(p(),v("div",te,[m(Ye,{name:"ri-error-warning-line",scale:"0.8",class:"mr-1"}),l[6]||(l[6]=h(" Suspendido ",-1))])):x("",!0),b("div",ae,[b("div",le,[m(Ye,{name:"io-star",class:"text-yellow-500",scale:"1.1"}),b("span",se,y(k(t)(null===(j=rt.value)||void 0===j?void 0:j.rating).toFixed(1)),1)]),l[7]||(l[7]=b("div",{class:"h-4 w-px bg-slate-200"},null,-1)),b("span",ie,y(null===(E=rt.value)||void 0===E||null===(E=E.rating)||void 0===E?void 0:E.count)+" Calificaciones",1)])]),b("div",ne,[b("div",re,[l[8]||(l[8]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Cédula Profesional",-1)),b("span",oe,y((null===(A=rt.value)||void 0===A?void 0:A.professionalId)||"No registrada"),1)]),b("div",de,[l[9]||(l[9]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Años de Exp.",-1)),b("span",ue,y((null===(D=rt.value)||void 0===D?void 0:D.experienceYears)||"10+")+" años",1)]),b("div",ce,[l[10]||(l[10]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Cédula Profesional",-1)),b("span",ve,y((null===(N=rt.value)||void 0===N?void 0:N.professionalId)||"No registrada"),1)]),b("div",pe,[l[11]||(l[11]=b("span",{class:"text-xs font-bold text-slate-400 uppercase"},"Resúmen",-1)),b("span",be,y((null===(S=rt.value)||void 0===S?void 0:S.bio)||"No registrado"),1)])])]),b("div",xe,[b("div",ge,[b("div",me,y((null===($=rt.value)||void 0===$||null===($=$.rating)||void 0===$?void 0:$.count)||0)+"+",1),l[12]||(l[12]=b("div",{class:"text-[10px] font-bold text-blue-600/70 uppercase"},"Consultas",-1))]),b("div",fe,[b("div",he,y(k(t)(null===(F=rt.value)||void 0===F?void 0:F.rating).toFixed(1)),1),b("div",ye,"Extrellas ("+y(null===(I=rt.value)||void 0===I||null===(I=I.rating)||void 0===I?void 0:I.count)+" calificaciones)",1)])])]),b("section",we,[b("div",ke,[b("div",Ue,[b("div",Ce,[b("div",Be,[m(Ye,{name:"bi-calendar-check"})]),l[13]||(l[13]=b("div",null,[b("h2",{class:"text-xl font-bold text-slate-800"},"Agenda de Citas"),b("p",{class:"text-slate-400 text-sm font-medium"},"Selecciona un horario disponible")],-1))]),lt.value?(p(),v("div",_e,[m(Ye,{class:"animate-bounce",name:"bi-calendar",scale:"1.4"}),b("span",je,"Tiene una cita agendada para el "+y(st.value),1),m(Ke,{to:"/client-appointments"},{default:f(()=>[b("button",Ee,[l[14]||(l[14]=h("Ver citas ",-1)),m(Ye,{name:"bi-arrow-right",scale:"1"})])]),_:1})])):x("",!0)]),b("div",Ae,[ut(null===(Je=rt.value)||void 0===Je?void 0:Je.specialty)?(p(),v("div",De,[(p(!0),v(U,null,C(Ge.value,(e,t)=>(p(),v("div",{key:t,class:"flex-shrink-0 w-48 space-y-4"},[b("div",Ne,y(t),1),b("div",Se,[(p(!0),v(U,null,C(e,(e,a)=>(p(),v("button",{key:a,onClick:a=>et(t,e.time),disabled:e.isAvailable||null!=e.takenBy&&e.takenBy!==k(r)().getUserUid,class:B(["w-full py-3 px-2 rounded-2xl text-sm font-bold transition-all duration-300 transform active:scale-95 flex flex-col items-center gap-1",e.isAvailable?"bg-slate-50 text-slate-300 border border-slate-100 cursor-not-allowed":"",e.isAvailable||null!=e.takenBy?"":"bg-white text-slate-700 border-2 border-slate-100 hover:border-blue-500 hover:text-blue-600",e.takenBy!==k(r)().getUserUid||e.takenAt?"":"bg-blue-600 text-white border-blue-600 shadow-lg scale-[1.02]",e.takenBy===k(r)().getUserUid&&e.takenAt?"bg-green-500 text-white border-green-500 shadow-lg":"",null!=e.takenBy&&e.takenBy!==k(r)().getUserUid?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":""])},[h(y(e.time)+" ",1),b("span",Fe,[e.isAvailable||null!=e.takenBy?e.takenBy===k(r)().getUserUid?(p(),v(U,{key:1},[h("Seleccionado")],64)):null!=e.takenBy?(p(),v(U,{key:2},[h("Ocupado")],64)):(p(),v(U,{key:3},[h("Indisponible")],64)):(p(),v(U,{key:0},[h("Disponible")],64))])],10,$e))),128))])]))),128))])):(p(),v("div",Ie,[m(Ye,{name:"ri-user-smile-line",scale:"3",class:"text-slate-300 mb-4"}),l[15]||(l[15]=b("h3",{class:"text-lg font-bold text-slate-500"},"Ha agotado sus citas gratuitas para esta categoria ",-1)),l[16]||(l[16]=b("p",{class:"text-slate-400 max-w-xs mx-auto text-sm mt-2"},"Para poder continuar con una cita le recomendamos contratar al experto profesional.",-1)),b("button",{onClick:vt,class:"mt-4 px-6 py-2 bg-blue-600 text-white font-bold rounded-2xl hover:bg-blue-700"},"Contratar")]))]),m(w,{"enter-active-class":"animate__animated animate__fadeInUp","leave-active-class":"animate__animated animate__fadeOutDown"},{default:f(()=>[it.value?(p(),v("div",Le,[b("div",Me,[b("div",Oe,[m(Ye,{name:"bi-calendar-check",scale:"1.2"})]),b("div",null,[l[17]||(l[17]=b("p",{class:"text-white/60 text-xs font-bold uppercase tracking-widest"},"Cita Seleccionada",-1)),b("h4",Ve,y(it.value),1)])]),b("button",{onClick:at,disabled:Re.value,class:"w-full md:w-auto px-10 py-4 bg-white text-blue-700 hover:bg-blue-50 font-extrabold rounded-2xl shadow-xl transition-all flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50"},[b("span",null,y(Re.value?"Procesando...":"Confirmar Cita Ahora"),1),Re.value?x("",!0):(p(),_(Ye,{key:0,name:"hi-paper-airplane"}))],8,He)])):x("",!0)]),_:1})])])])])):(p(),v("div",V,[...l[0]||(l[0]=[g('<div class="grid grid-cols-1 lg:grid-cols-12 gap-8" data-v-cb52ce31><div class="lg:col-span-4 bg-white rounded-3xl p-8 shadow-sm h-96" data-v-cb52ce31></div><div class="lg:col-span-8 space-y-6" data-v-cb52ce31><div class="bg-white rounded-3xl p-8 shadow-sm h-48" data-v-cb52ce31></div><div class="bg-white rounded-3xl p-8 shadow-sm h-96" data-v-cb52ce31></div></div></div>',1)])]))]),a.value?(p(),v("div",Pe,[b("div",qe,[l[18]||(l[18]=b("div",{class:"w-20 h-20 border-4 border-white/20 border-t-white rounded-full animate-spin"},null,-1)),b("div",Te,[m(Ye,{name:"hi-paper-airplane",class:"text-white animate-pulse",scale:"1.5"})])]),b("p",ze,y(L.value),1)])):x("",!0)])}}}),[["__scopeId","data-v-cb52ce31"]]))}}});
