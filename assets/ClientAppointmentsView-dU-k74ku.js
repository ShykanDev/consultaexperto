import{a as be,i as $e,k as v,Z as T,l as ye,j as he,r as ve,b as d,o as r,f as p,e,Y as Ue,n as C,x as G,t as f,q as Z,L as m,F as U,v as N,W as ee,g as h,w as de,p as E,A as _e,$ as ce,J as B,K as ue,V as pe,a0 as fe,a1 as oe,G as Ne,E as Se,H as Ie,a2 as Ae,m as Be,a3 as me,y as J}from"./index-DHhmkvBm.js";import{G as ge}from"./GenericModal-BboUOLXN.js";import{e as xe}from"./index-DfBlkqaH.js";import{u as Le}from"./expertUi-DtyoothA.js";import{u as je}from"./hiring-CBPf2Wtt.js";import{B as Re}from"./index-z5cnng5s.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                */const ze={class:"w-full mb-4 font-poppins"},Me={class:"flex items-start justify-between gap-4"},Te={class:"flex items-start gap-4 flex-1"},Ve={class:"flex flex-col min-w-0"},Pe={class:"flex items-center gap-2 mb-1"},Oe={class:"text-xs text-gray-400 font-medium whitespace-nowrap"},qe={class:"text-base font-bold text-gray-800 leading-tight truncate pr-2"},He={class:"text-sm text-gray-500 font-medium truncate mb-2"},Xe={class:"flex items-center flex-wrap gap-3 mt-1 text-sm text-gray-600"},Je={class:"flex items-center gap-1.5 bg-gray-50 px-2 py-1 rounded-lg"},Ye={class:"font-semibold"},Ke={class:"flex items-center gap-1.5 bg-gray-50 px-2 py-1 rounded-lg"},We={class:"font-semibold"},Ze={key:0,class:"flex items-center gap-1 mt-2"},Ge={class:"flex flex-col items-center justify-center h-full pl-2 border-l border-gray-50"},Qe={key:1,class:"bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden animate-fade-in-up"},et={class:"bg-gray-50/80 backdrop-blur-sm border-b border-gray-100 p-4 sticky top-0 z-10 flex items-center justify-between"},tt={class:"p-6 space-y-8"},at={class:"text-center space-y-4"},st={class:"relative inline-block"},ot={key:0,class:"absolute -bottom-2 -right-2 bg-yellow-400 text-white p-1.5 rounded-full shadow-sm"},nt={class:"text-2xl font-bold text-gray-800"},rt={class:"text-gray-500 mt-1"},it={class:"text-sm text-gray-400 font-medium"},lt={key:0,class:"flex justify-center"},dt={key:1,class:"flex flex-col items-center gap-1 bg-gray-50 px-4 py-2 rounded-xl"},ct={class:"flex gap-1"},ut={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pt={class:"bg-gray-50 rounded-2xl p-5 border border-gray-100"},ft={class:"text-sm font-bold text-gray-800 uppercase tracking-widest mb-4 flex items-center gap-2"},mt={class:"space-y-4"},gt={class:"flex justify-between items-center p-3 bg-white rounded-xl shadow-sm"},xt={class:"font-semibold text-gray-800 text-sm capitalize"},bt={class:"flex justify-between items-center p-3 bg-white rounded-xl shadow-sm"},yt={class:"font-semibold text-gray-800 text-sm"},ht={class:"flex justify-between items-center p-3 bg-white rounded-xl shadow-sm"},vt={class:"font-semibold text-gray-800 text-xs"},_t={key:0,class:"p-3 bg-blue-50/50 rounded-xl border border-blue-100"},wt={class:"flex items-start gap-3"},Ct={class:"bg-blue-100 rounded-lg p-2 text-blue-600"},kt={class:"flex-1"},Ft={key:0,class:"text-xs text-blue-700"},Dt={key:1,class:"text-xs text-blue-700 flex items-center gap-1"},Et={key:2},$t={class:"space-y-6"},Ut={class:"bg-gray-50 rounded-2xl p-5 border border-gray-100"},Nt={class:"text-sm font-bold text-gray-800 uppercase tracking-widest mb-4 flex items-center gap-2"},St={class:"flex items-center gap-4 bg-white p-4 rounded-xl shadow-sm border border-gray-100"},It={class:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 text-xl font-bold"},At={class:"flex-1 min-w-0"},Bt={class:"text-gray-900 font-bold text-sm truncate"},Lt={class:"text-gray-500 text-xs"},jt={class:"mt-4 text-center"},Rt={class:"flex items-center justify-center gap-1 mt-1"},zt={class:"absolute right-0 top-0 opacity-10 transform translate-x-1/4 -translate-y-1/4"},Mt={class:"relative z-10 flex items-center gap-3"},Tt={class:"bg-white/20 p-2 rounded-lg"},Vt={key:0,class:"bg-red-50 rounded-2xl p-5 border border-red-100"},Pt={class:"text-sm font-bold text-red-800 uppercase tracking-widest mb-3 flex items-center gap-2"},Ot={class:"space-y-2 text-sm"},qt={class:"text-red-700"},Ht={class:"text-red-600 text-xs"},Xt={class:"text-red-600 text-xs"},Jt={key:0,class:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-100"},Yt=["disabled"],Kt={class:"space-y-4"},Wt={class:"space-y-6 text-center"},Zt={class:"text-sm text-gray-500"},Gt={class:"font-semibold text-gray-800"},Qt={class:"flex flex-col gap-3"},ea=["onClick"],ta={class:"flex gap-1 text-lg group-hover:scale-110 transition-transform"},aa=be({__name:"CardInfo",props:{data:{type:Object,required:!0},index:{type:Number}},setup(re){const Y=$e(),V=v(!1),P=v(!1),L=v(5),D=v([{specialty:"ImportaciÃ³n y ExportaciÃ³n",color:{light:"#E6F3FF",strong:"#0066CC"},icon:"fa-truck-moving",description:"Facilitamos el intercambio de bienes y servicios a nivel internacional con normativas seguras."},{specialty:"MÃ©dico",color:{light:"#E6F7FF",strong:"#0099CC"},icon:"gi-stethoscope",description:"Profesionales de la salud comprometidos en atender tus necesidades mÃ©dicas de forma personalizada."},{specialty:"Contador",color:{light:"#E6FFE6",strong:"#008000"},icon:"bi-calculator-fill",description:"Expertos en contabilidad para gestionar tus finanzas de forma precisa y confiable."},{specialty:"Arquitecto",color:{light:"#F0E6FF",strong:"#6600CC"},icon:"md-architecture-sharp",description:"DiseÃ±o y planificaciÃ³n de espacios con profesionalismo y creatividad."},{specialty:"Servicios Web",color:{light:"#E6F9FF",strong:"#00BFFF"},icon:"md-web",description:"Desarrollo de soluciones digitales a medida para potenciar tu presencia online."},{specialty:"Publicidad",color:{light:"#FFF0E6",strong:"#FF6600"},icon:"ri-newspaper-fill",description:"Estrategias creativas para difundir y potenciar la imagen de tu marca."},{specialty:"Traductores",color:{light:"#FFF8E6",strong:"#FFD700"},icon:"hi-solid-translate",description:"Especialistas en comunicaciÃ³n multilingÃ¼e para romper barreras idiomÃ¡ticas."},{specialty:"Peritaje",color:{light:"#F0E6FF",strong:"#800080"},icon:"gi-sherlock-holmes",description:"Evaluaciones tÃ©cnicas y profesionales con rigor y precisiÃ³n."},{specialty:"IngenierÃ­a en ComputaciÃ³n",color:{light:"#E6FFFA",strong:"#00CED1"},icon:"md-computer-twotone",description:"InnovaciÃ³n tecnolÃ³gica y desarrollo de sistemas a la vanguardia."},{specialty:"GestorÃ­a en TrÃ¡mites",color:{light:"#E6E6FF",strong:"#4B0082"},icon:"ri-newspaper-fill",description:"Optimiza tus gestiones administrativas con asesorÃ­as especializadas."},{specialty:"Marketing",color:{light:"#FFE6F0",strong:"#FF1493"},icon:"ri-marketing-strategy-fill",description:"Conecta con tu audiencia a travÃ©s de estrategias innovadoras y efectivas."},{specialty:"Abogado",color:{light:"#F5E6D3",strong:"#8B4513"},icon:"fa-balance-scale",description:"Conecta con un abogado especializado para recibir asesorÃ­a legal directa y resolver tus asuntos jurÃ­dicos."},{specialty:"PsicÃ³logo/a",color:{light:"#E6E6FF",strong:"#6A5ACD"},icon:"ri-psychotherapy-fill",description:"AsesorÃ­a psicolÃ³gica para resolver tus dudas y resolver tus problemas."},{specialty:"Maestro",color:{light:"#F0FFF0",strong:"#2E8B57"},icon:"gi-teacher",description:"AsesorÃ­a educativa para resolver tus dudas y resolver tus problemas."},{specialty:"Chef",color:{light:"#FFE6E6",strong:"#FF4500"},icon:"gi-chef-toque"}]),S=s=>{if(t.data.isCanceled)return"#fff0f0";if(t.data.isFinished)return"#f0fff0";if(!t.data.isFinished&&!t.data.isCanceled)return"#f0fbff";const a=D.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.color.light:"#E6E6E6"},O=s=>{if(t.data.isCanceled)return"#ff8080";if(t.data.isFinished)return"#00966A";const a=D.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.color.strong:"#E6E6E6"},te=s=>{const a=D.value.find(o=>o.specialty.toLowerCase().trim()===s.toLowerCase().trim());return a?a.icon:""};v(!0);const t=re,ae=s=>{const a=["domingo","lunes","martes","miercoles","jueves","viernes","sabado"],o=s.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return a.findIndex(g=>o.includes(g))},$=T(()=>{var c;if(t.data.appointmentDate)return new Date(t.data.appointmentDate.seconds*1e3);if(!((c=t.data)!=null&&c.createdAt))return null;const s=new Date(t.data.createdAt.seconds*1e3),a=s.getDay(),o=t.data.DayName||t.data.dayName||"",g=ae(o);if(g===-1)return s;let b=g-a;b<0&&(b+=7);const y=new Date(s);return y.setDate(s.getDate()+b),y}),q=T(()=>$.value?$.value.toLocaleDateString("es-MX",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"Fecha no disponible"),j=T(()=>t.data.expertSchedule.time),H=T(()=>{var s;return((s=$.value)==null?void 0:s.toLocaleDateString("es-MX",{weekday:"long"}))||t.data.DayName}),R=v("card");ye(()=>{xe.init({blockHeadless:!0,publicKey:"8uRc3wp2ZXACkO_Eb"})});const K=async s=>{var a;try{xe.send("service_q9e8lj2","template_lv5dfds",{headerTitle:"ConsultaExperto.com",greeting:"Se ha cancelado su cita",userName:t.data.userName,headerDescription:"ConfirmaciÃ³n de cancelaciÃ³n de cita",section1Icon:"ðŸ‘¤",section1Title:"InformaciÃ³n del usuario",section1TitleColor:"#007aff",section1Item1Label:"Nombre:",section1Item1Value:t.data.userName,section1Item2Label:"Servicio:",section1Item2Value:t.data.expertSpecialty,section2Icon:"ðŸ“…",section2Title:"Cita cancelada",section2TitleColor:"#ff3b30",section2Subtitle1:"Cita programada para",section2Value1:"â€¢ ".concat((a=$.value)==null?void 0:a.toLocaleString("es-MX",{dateStyle:"full"})," a las ").concat(j.value,"hrs"),section2Subtitle2:"Cancelada el",section2Value2:s.toDate().toLocaleString("es-MX",{dateStyle:"full",timeStyle:"long"}),section2HighlightLabel:"Cancelada por:",section2HighlightText:"".concat(m().getUserName,",  con motivo: ").concat(A.value||"Motivo no proporcionado"),section3Icon:"ðŸ©º",section3Title:"Datos del experto",section3TitleColor:"#8e8e93",section3Item1Label:"Nombre",section3Item1Value:t.data.expertName,section3Item2Label:"CÃ©dula",section3Item2Value:t.data.expertProfessionalId,footerYear:new Date().getFullYear(),footerLinkUrl:"https://consultaexperto.com",footerLinkText:"consultaexperto.com",footerRightsText:"Todos los derechos reservados.",email:m().getUserEmail})}catch(o){console.log(o)}},X=()=>{R.value=R.value==="card"?"modal":"card"},W=()=>{if(t.data.isCanceled||t.data.isFinished){console.log("La cita ya fue cancelada o finalizada");return}if(!t.data.isOpenedLinkByExpert){console.log("El experto no ha abierto la cita");return}try{Re.open({url:t.data.appointmentLink})}catch(s){console.log(s)}},_=he(),l=s=>s.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim(),n=async()=>{try{const s=pe.now(),a=B(_,"experts/".concat(t.data.expertUid)),o=await ue(a);if(!o.exists())return console.log("Could not find the expert document"),!1;const g=o.data().schedule;console.log("Expert Data: ".concat(JSON.stringify(g))),console.log("Formatted Day: ".concat(l(H.value)));const b=Object.keys(g).find(se=>l(se)==l(H.value));console.log("Match Day: ".concat(b));const y=g[b];console.log("Expert Schedule Slot: ".concat(y));const c=y==null?void 0:y.find(se=>se.takenBy==t.data.userUid);if(console.log("Slot Match: ".concat(c)),!c)return console.log("Could not find the expert slot for this appointment"),!1;if(c.takenBy=null,c.takenAt=null,!t.data.docRef)return console.log("Couldn't find docRef for this document "),!1;const w=ce(_);w.update(a,{schedule:g}),console.log("Document doc Ref: ".concat(t.data.docRef)),w.update(B(_,"schedules/".concat(t.data.docId)),{isCanceled:!0,cancelationReason:A.value,canceledAt:s,canceledByUid:m().getUserUid||"",canceledByName:m().getUserName||""});const Q="".concat(t.data.expertUid,"_").concat(b,"_").concat(c.time),M=B(_,"bookings",Q);return w.delete(M),console.log("Guardian deleted: ".concat(Q)),await w.commit(),await K(s),console.log("Appointment canceled successfully"),!0}catch(s){return console.error("Error in batch function:",s),!1}},u=v(!1),i=v(""),x=async()=>{try{u.value=!0,i.value="Finalizando cita...";const s=ce(_),a=B(_,"experts/".concat(t.data.expertUid)),o=await ue(a);if(!o.exists())return console.log("Could not find the expert document"),u.value=!1,!1;const g=o.data().schedule;console.log("Expert Data: ".concat(JSON.stringify(g))),console.log("Formatted Day: ".concat(l(H.value)));const b=Object.keys(g).find(M=>l(M)==l(H.value));console.log("Match Day: ".concat(b));const y=g[b];console.log("Expert Schedule Slot: ".concat(y));const c=y==null?void 0:y.find(M=>M.takenBy==t.data.userUid);if(console.log("Slot Match: ".concat(c)),!c)return console.log("Could not find the expert slot for this appointment"),u.value=!1,!1;c.takenBy=null,c.takenAt=null,s.update(a,{schedule:g}),s.update(B(_,"schedules/".concat(t.data.docId)),{isFinished:!0,finishedAt:pe.now(),finishedByUid:m().getUserUid||"UID no disponible",finishedByName:m().getUserName||"Nombre no disponible"});const w="".concat(t.data.expertUid,"_").concat(b,"_").concat(c.time),Q=B(_,"bookings",w);s.delete(Q),console.log("Guardian deleted: ".concat(w)),await s.commit(),u.value=!1;try{k()}catch(M){console.error("Error presenting rating alert",M)}}catch(s){console.error("Error finalizando la cita:",s),u.value=!1}},k=()=>{P.value=!0},F=async()=>{try{await I(L.value),await z(L.value)}catch(s){console.error("Error updating rating:",s)}P.value=!1},I=async s=>{if(s<1||s>5)return!1;if(!m().getUserUid||!m().getUserName)return console.log("No user data available"),!1;console.log("Is user Expert: ".concat(m().getIsExpert)),console.log("User UID: ".concat(m().getUserUid)),console.log("User Name: ".concat(m().getUserName));const a=m().getIsExpert?"users":"experts",o=m().getIsExpert?"User":"Expert",g=a==="users"?t.data.userUid:t.data.expertUid;let b;try{b=B(_,"".concat(a,"/").concat(g)),await fe(b,{["rating.stars.".concat(s)]:oe(1),"rating.total":oe(s),"rating.count":oe(1),["ratedBy".concat(o)]:!0}),console.log("".concat(a," stars updated successfully to user with uid: ").concat(g))}catch(y){console.log("Error trying to update ".concat(a," stars : ").concat(y))}},z=async s=>{if(s<1||s>5)return!1;if(!m().getUserUid||!m().getUserName)return console.log("No user data available"),!1;const a=m().getIsExpert?"Expert":"User";let o;try{o=B(_,"".concat(t.data.docRef.path)),await fe(o,{["ratedBy".concat(a)]:!0,["consultRatingBy".concat(a)]:s}),console.log("".concat(a," consult rating updated successfully to user with uid: ").concat(m().getUserUid))}catch(g){console.log("Error trying to update ".concat(a," consult rating : ").concat(g))}},A=v(""),Ce=()=>{V.value=!0},ke=async()=>{A.value.trim()&&(V.value=!1,await n())},ie=async()=>{if(!le(t.data.expertUid))try{if(!t.data.expertUid){console.error("No expert UID provided");return}Le().setExpertUid(t.data.expertUid),Y.push("/expert-info-fixed")}catch(a){console.error("Navigation error:",a)}},Fe=je(),De=()=>{!t.data.expertName||!t.data.expertSpecialty||!t.data.expertUid||(Fe.setExpertHiringData(t.data.expertName,t.data.expertSpecialty,t.data.expertUid),Y.push("/hiring"))},le=s=>{var o;if(!s)return!1;const a=(o=m().getUserData)==null?void 0:o.expertsBlocked;return a?a[s]?(console.log("Expert ".concat(s," is blocked")),!0):(console.log("Expert ".concat(s," is not blocked")),!1):!1},Ee=v(!1);return R.value==="modal"&&(Ee.value=le(t.data.expertUid)),(s,a)=>{var g,b,y;const o=ve("v-icon");return r(),d("div",ze,[R.value==="card"?(r(),d("div",{key:0,onClick:X,class:"group relative bg-white rounded-2xl p-5 border border-gray-100 shadow-sm hover:shadow-md transition-all duration-300 cursor-pointer overflow-hidden"},[a[4]||(a[4]=e("div",{class:"absolute top-0 left-0 w-1 h-full bg-blue-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",Me,[e("div",Te,[e("div",{class:"w-14 h-14 rounded-xl flex items-center justify-center flex-shrink-0 transition-transform group-hover:scale-105",style:Ue({backgroundColor:S(t.data.expertSpecialty),color:O(t.data.expertSpecialty)})},[p(o,{name:te(t.data.expertSpecialty),scale:"1.5"},null,8,["name"])],4),e("div",Ve,[e("div",Pe,[e("span",{class:G(["text-[10px] uppercase tracking-wider font-bold px-2 py-0.5 rounded-full",{"bg-emerald-100 text-emerald-700":t.data.isFinished,"bg-red-100 text-red-700":t.data.isCanceled,"bg-blue-100 text-blue-700":!t.data.isFinished&&!t.data.isCanceled}])},f(t.data.isFinished?"Finalizada":t.data.isCanceled?"Cancelada":"Programada"),3),e("span",Oe,f((g=t.data.createdAt)==null?void 0:g.toDate().toLocaleDateString("es-MX")),1)]),e("h3",qe,f(t.data.expertName),1),e("p",He,f(t.data.expertSpecialty),1),e("div",Xe,[e("div",Je,[p(o,{name:"fa-calendar-alt",scale:"0.8",class:"text-blue-500"}),e("span",Ye,f(q.value),1)]),e("div",Ke,[p(o,{name:"fa-clock",scale:"0.8",class:"text-blue-500"}),e("span",We,f(j.value)+" hrs",1)])]),Z(m)().getIsClient&&t.data.isFinished?(r(),d("div",Ze,[(r(!0),d(U,null,N(t.data.consultRatingByUser,(c,w)=>(r(),ee(o,{class:"text-yellow-400",key:w,name:"bi-star-fill",scale:"0.7"}))),128))])):C("",!0)])]),e("div",Ge,[p(o,{name:"fa-chevron-right",class:"text-gray-300 group-hover:text-blue-500 transition-colors"})])])])):(r(),d("div",Qe,[e("div",et,[e("button",{onClick:X,class:"flex items-center gap-2 text-gray-600 hover:text-blue-600 transition-colors font-medium text-sm px-3 py-1.5 rounded-lg hover:bg-white hover:shadow-sm"},[p(o,{name:"fa-arrow-left",scale:"0.9"}),a[5]||(a[5]=e("span",null,"Volver",-1))]),a[6]||(a[6]=e("span",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest"},"Detalles de la Cita",-1))]),e("div",tt,[e("div",at,[e("div",st,[e("div",{class:G(["w-20 h-20 rounded-2xl flex items-center justify-center mx-auto shadow-sm",{"bg-emerald-50 text-emerald-600":t.data.isFinished,"bg-red-50 text-red-600":t.data.isCanceled,"bg-blue-50 text-blue-600":!t.data.isFinished&&!t.data.isCanceled}])},[p(o,{name:t.data.isFinished?"fa-check-circle":t.data.isCanceled?"fa-times-circle":"fa-calendar-check",scale:"2.5"},null,8,["name"])],2),t.data.isFinished&&!t.data.ratedByUser?(r(),d("div",ot,[p(o,{name:"bi-star-fill",scale:"0.8"})])):C("",!0)]),e("div",null,[e("h2",nt,f(t.data.isFinished?"Cita Finalizada":t.data.isCanceled?"Cita Cancelada":"Cita\n              Programada"),1),e("p",rt,[a[7]||(a[7]=h(" Con ",-1)),e("span",{class:"font-semibold text-blue-600 cursor-pointer hover:underline",onClick:ie},f(t.data.expertName),1)]),e("p",it,f(t.data.expertSpecialty),1)]),!t.data.isCanceled&&t.data.isFinished?(r(),d("div",lt,[t.data.ratedByUser?(r(),d("div",dt,[a[9]||(a[9]=e("span",{class:"text-xs text-gray-400"},"Su calificaciÃ³n",-1)),e("div",ct,[(r(!0),d(U,null,N(t.data.consultRatingByUser,c=>(r(),ee(o,{class:"text-yellow-400",key:c,name:"bi-star-fill",scale:"0.9"}))),128))])])):(r(),d("button",{key:0,onClick:k,class:"bg-yellow-50 text-yellow-700 px-4 py-2 rounded-xl text-sm font-semibold hover:bg-yellow-100 transition-colors flex items-center gap-2 border border-yellow-200"},[a[8]||(a[8]=e("span",null,"Calificar Experto",-1)),p(o,{name:"bi-star",scale:"1"})]))])):C("",!0)]),e("div",ut,[e("div",pt,[e("h3",ft,[p(o,{name:"bi-calendar-event",class:"text-blue-500"}),a[10]||(a[10]=h(" Datos de la Cita ",-1))]),e("div",mt,[e("div",gt,[a[11]||(a[11]=e("span",{class:"text-gray-500 text-sm"},"Fecha",-1)),e("span",xt,f(q.value),1)]),e("div",bt,[a[12]||(a[12]=e("span",{class:"text-gray-500 text-sm"},"Hora",-1)),e("span",yt,f(j.value)+" hrs",1)]),e("div",ht,[a[13]||(a[13]=e("span",{class:"text-gray-500 text-sm"},"Creada",-1)),e("span",vt,f((b=t.data.createdAt)==null?void 0:b.toDate().toLocaleString("es-MX",{dateStyle:"short",timeStyle:"short"})),1)]),!t.data.isCanceled&&!t.data.isFinished?(r(),d("div",_t,[e("div",wt,[e("div",Ct,[p(o,{name:"co-link",scale:"1"})]),e("div",kt,[a[17]||(a[17]=e("h4",{class:"text-sm font-bold text-blue-900 mb-1"},"Enlace de video",-1)),!t.data.appointmentLink&&!t.data.acceptedByExpert?(r(),d("p",Ft," Se generarÃ¡ cuando el experto confirme. ")):t.data.appointmentLink&&t.data.acceptedByExpert&&!t.data.isOpenedLinkByExpert?(r(),d("p",Dt,[p(o,{name:"fa-check-circle",scale:"0.8"}),a[14]||(a[14]=h(" Confirmada. Enlace disponible al iniciar. ",-1))])):C("",!0),t.data.appointmentLink&&t.data.acceptedByExpert&&t.data.isOpenedLinkByExpert?(r(),d("div",Et,[a[16]||(a[16]=e("p",{class:"text-xs text-blue-800 mb-2"},"Â¡La sala estÃ¡ abierta!",-1)),e("button",{onClick:W,class:"w-full bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 rounded-lg transition-colors flex items-center justify-center gap-2 animate-fade-up"},[p(o,{name:"bi-camera-video-fill"}),a[15]||(a[15]=h(" Unirse ahora ",-1))])])):C("",!0)])])])):C("",!0)])]),e("div",$t,[e("div",Ut,[e("h3",Nt,[p(o,{name:"fa-user-tie",class:"text-blue-500"}),a[18]||(a[18]=h(" Experto ",-1))]),e("div",St,[e("div",It,f(t.data.expertName?t.data.expertName.charAt(0):"E"),1),e("div",At,[e("h4",Bt,f(t.data.expertName),1),e("p",Lt,"CÃ©dula: "+f(t.data.expertProfessionalId),1)]),e("button",{onClick:ie,class:"text-blue-600 hover:text-blue-700"},[p(o,{name:"fa-external-link-alt",scale:"0.8"})])]),e("div",jt,[a[19]||(a[19]=e("p",{class:"text-xs text-gray-500"}," CalificaciÃ³n del experto ",-1)),e("div",Rt,[(r(!0),d(U,null,N(t.data.expertRating,(c,w)=>(r(),ee(o,{class:"text-yellow-400",key:w,name:"bi-star-fill",scale:"0.7"}))),128))])]),t.data.isFinished&&Z(m)().getIsClient?(r(),d("div",{key:0,onClick:De,class:"mt-4 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-4 text-white cursor-pointer hover:shadow-lg transition-shadow relative overflow-hidden group"},[e("div",zt,[p(o,{name:"fa-user-tie",scale:"5"})]),e("div",Mt,[e("div",Tt,[p(o,{name:"fa-briefcase"})]),a[20]||(a[20]=e("div",{class:"flex-1"},[e("p",{class:"font-bold text-sm"},"Â¿Le gustÃ³ el servicio?"),e("p",{class:"text-xs text-blue-100"},"Contratae una asesorÃ­a completa")],-1)),p(o,{name:"fa-chevron-right",scale:"0.8",class:"group-hover:translate-x-1 transition-transform"})])])):C("",!0)]),t.data.isCanceled?(r(),d("div",Vt,[e("h3",Pt,[p(o,{name:"fa-info-circle"}),a[21]||(a[21]=h(" CancelaciÃ³n ",-1))]),e("div",Ot,[e("p",qt,[a[22]||(a[22]=e("span",{class:"font-semibold"},"Motivo:",-1)),h(" "+f(t.data.cancelationReason),1)]),e("p",Ht,[a[23]||(a[23]=e("span",{class:"font-semibold"},"Cancelado por:",-1)),h(" "+f(t.data.canceledByName),1)]),e("p",Xt,[a[24]||(a[24]=e("span",{class:"font-semibold"},"Fecha:",-1)),h(" "+f((y=t.data.canceledAt)==null?void 0:y.toDate().toLocaleString("es-MX")),1)])])])):C("",!0)])]),!t.data.isFinished&&!t.data.isCanceled?(r(),d("div",Jt,[t.data.acceptedByExpert&&Z(m)().getIsExpert?(r(),d("button",{key:0,onClick:x,class:"flex-1 bg-emerald-500 hover:bg-emerald-600 text-white font-semibold py-3 px-4 rounded-xl transition-colors shadow-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:u.value},[p(o,{name:"bi-calendar-check"}),h(" "+f(u.value?i.value:"Marcar como Finalizada"),1)],8,Yt)):C("",!0),!t.data.acceptedByExpert||t.data.acceptedByExpert&&!u.value?(r(),d("button",{key:1,onClick:Ce,class:"flex-1 bg-white border border-rose-200 text-rose-600 hover:bg-rose-50 font-semibold py-3 px-4 rounded-xl transition-colors flex items-center justify-center gap-2"},[p(o,{name:"bi-calendar-x-fill"}),a[25]||(a[25]=h(" Cancelar Cita ",-1))])):C("",!0),e("button",{class:"flex-1 bg-gray-50 border border-gray-200 text-gray-600 hover:bg-gray-100 font-semibold py-3 px-4 rounded-xl transition-colors flex items-center justify-center gap-2",onClick:a[0]||(a[0]=c=>Z(Y).push("/help"))},[p(o,{name:"md-supportagent-outlined"}),a[26]||(a[26]=h(" Reportar Problema ",-1))])])):C("",!0)])])),p(ge,{show:V.value,"onUpdate:show":a[2]||(a[2]=c=>V.value=c),title:"Cancelar Cita",confirmText:"Confirmar CancelaciÃ³n",onConfirm:ke},{default:de(()=>[e("div",Kt,[a[27]||(a[27]=e("p",{class:"text-sm text-gray-500"},"Por favor, indique el motivo de la cancelaciÃ³n:",-1)),E(e("textarea",{"onUpdate:modelValue":a[1]||(a[1]=c=>A.value=c),class:"w-full p-4 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-sm",rows:"3",placeholder:"Escribe el motivo aquÃ­..."},null,512),[[_e,A.value]])])]),_:1},8,["show"]),p(ge,{show:P.value,"onUpdate:show":a[3]||(a[3]=c=>P.value=c),title:"Calificar servicio",confirmText:"Enviar CalificaciÃ³n",onConfirm:F},{default:de(()=>[e("div",Wt,[e("p",Zt,[a[28]||(a[28]=h(" Â¿CÃ³mo calificarÃ­as tu experiencia con ",-1)),e("span",Gt,f(Z(m)().getIsExpert?t.data.userName:t.data.expertName),1),a[29]||(a[29]=h("? ",-1))]),e("div",Qt,[(r(),d(U,null,N([5,4,3,2,1],c=>e("button",{key:c,onClick:w=>L.value=c,class:G(["w-full flex items-center justify-between p-4 rounded-xl border-2 transition-all cursor-pointer group",L.value===c?"border-blue-500 bg-blue-50/50":"border-gray-100 hover:border-blue-200 bg-white"])},[e("span",{class:G(["font-bold text-sm",L.value===c?"text-blue-600":"text-gray-600"])},f(c)+" Estrellas",3),e("div",ta,[(r(!0),d(U,null,N(c,w=>(r(),ee(o,{key:w,name:"bi-star-fill",class:"text-yellow-400"}))),128))])],10,ea)),64))])])]),_:1},8,["show"])])}}}),ne=we(aa,[["__scopeId","data-v-f75ca20a"]]),sa={class:"web-page min-h-screen bg-gradient-to-br from-blue-50 via-blue-50/50 to-white"},oa={class:"mt-28"},na={class:"web-toolbar h-16 flex items-center px-4 mt-2"},ra={class:"relative w-full"},ia={class:"web-toolbar h-auto flex flex-col sm:flex-row items-center px-4 gap-3 mb-4"},la={class:"flex-1 w-full flex flex-row gap-2"},da={class:"flex px-4 py-2 gap-2"},ca=["onClick"],ua={class:"animate-fade-in"},pa={class:"text-center px-4 py-2 flex items-center gap-2 justify-center bg-gray-50 mb-2 rounded-xl mx-4"},fa={class:"font-poppins text-sm font-semibold text-slate-600"},ma={class:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"},ga={key:0,class:"flex flex-col items-center justify-center p-8 text-center text-gray-500 font-poppins bg-white mx-4 rounded-xl border border-dashed border-gray-200"},xa={class:"px-4 space-y-3 pb-4"},ba={class:"animate-fade-in"},ya={class:"text-center px-4 py-2 flex items-center gap-2 justify-center bg-gray-50 mb-2 rounded-xl mx-4"},ha={class:"font-poppins text-sm font-semibold text-slate-600"},va={class:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"},_a={key:0,class:"flex flex-col items-center justify-center p-8 text-center text-gray-500 font-poppins bg-white mx-4 rounded-xl border border-dashed border-gray-200"},wa={class:"px-4 space-y-3 pb-4"},Ca={class:"animate-fade-in"},ka={class:"text-center px-4 py-2 flex items-center gap-2 justify-center bg-gray-50 mb-2 rounded-xl mx-4"},Fa={class:"font-poppins text-sm font-semibold text-slate-600"},Da={class:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent"},Ea={key:0,class:"flex flex-col items-center justify-center p-8 text-center text-gray-500 font-poppins bg-white mx-4 rounded-xl border border-dashed border-gray-200"},$a={class:"px-4 space-y-3 pb-4"},Ua=be({__name:"ClientAppointmentsView",setup(re){const Y=m(),V=he(),P=Ne(V,"schedules"),L=Se(P,Ie("userUid","==",Y.getUserUid)),D=v(!1),S=v([]);let O=null;ye(()=>{D.value=!0,O=Ae(L,l=>{if(S.value=[],l.empty){D.value=!1;return}l.forEach(n=>{const u=n.data();u.docId=n.id,u.docRef=n.ref,u.docRefPath=n.ref.path,S.value.push(u)}),D.value=!1},l=>{console.error(l),D.value=!1})}),Be(()=>{O&&(O(),O=null),S.value=[]});const te=[{id:"proximas",label:"PrÃ³ximas"},{id:"finalizadas",label:"Finalizadas"},{id:"canceladas",label:"Canceladas"}],t=v("proximas"),ae=l=>{t.value=l},$=v(""),q=v("creation"),j=v("Recientes"),H=l=>{const n=["domingo","lunes","martes","miercoles","jueves","viernes","sabado"];if(!l)return-1;const u=l.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");return n.findIndex(i=>u.includes(i))},R=l=>{if(l.appointmentDate)return new Date(l.appointmentDate.seconds*1e3);if(!l.createdAt)return null;const n=new Date(l.createdAt.seconds*1e3),u=n.getDay(),i=l.DayName||l.dayName||"",x=H(i);if(x===-1)return n;let k=x-u;k<0&&(k+=7);const F=new Date(n);if(F.setDate(n.getDate()+k),l.expertSchedule&&l.expertSchedule.time){const[I,z]=l.expertSchedule.time.split(":").map(Number);!isNaN(I)&&!isNaN(z)&&F.setHours(I,z,0,0)}return F},K=l=>{let n=[...l];if($.value){const u=$.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");n=n.filter(i=>{const x=(i.expertName||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),k=(i.expertSpecialty||"").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");let F="programada";return i.isFinished&&(F="finalizada"),i.isCanceled&&(F="cancelada"),!i.isFinished&&!i.isCanceled&&(u.includes("proxima")||u.includes("pendiente"))?!0:x.includes(u)||k.includes(u)||F.includes(u)})}return n.sort((u,i)=>{var F,I;let x=0,k=0;if(q.value==="creation")x=((F=u.createdAt)==null?void 0:F.seconds)||0,k=((I=i.createdAt)==null?void 0:I.seconds)||0;else{const z=R(u),A=R(i);x=z?z.getTime():0,k=A?A.getTime():0}return j.value==="Recientes"?k-x:x-k}),n},X=T(()=>{const l=S.value.filter(n=>n.isCanceled);return K(l)}),W=T(()=>{const l=S.value.filter(n=>n.isFinished);return K(l)}),_=T(()=>{const l=S.value.filter(n=>!n.isFinished&&!n.isCanceled);return K(l)});return(l,n)=>{const u=ve("v-icon");return r(),d("div",sa,[e("div",oa,[e("nav",na,[e("div",ra,[p(u,{class:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",name:"fa-search"}),E(e("input",{class:"web-search-input w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-2xl outline-none focus:ring-2 focus:ring-blue-100 transition-all font-medium","onUpdate:modelValue":n[0]||(n[0]=i=>$.value=i),placeholder:"Experto, especialidad o estado..."},null,512),[[_e,$.value]])])]),e("nav",ia,[e("div",la,[E(e("select",{class:"web-select w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-100 transition-all text-xs font-poppins","aria-label":"Listar por","onUpdate:modelValue":n[1]||(n[1]=i=>q.value=i)},[...n[3]||(n[3]=[e("option",{value:"creation"},"Fecha de CreaciÃ³n",-1),e("option",{value:"scheduled"},"Fecha Agendada",-1)])],512),[[me,q.value]]),E(e("select",{class:"web-select w-full p-3 bg-white border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-100 transition-all text-xs font-poppins","aria-label":"Ordenar por","onUpdate:modelValue":n[2]||(n[2]=i=>j.value=i)},[...n[4]||(n[4]=[e("option",{value:"Recientes"},"MÃ¡s recientes",-1),e("option",{value:"Antiguas"},"MÃ¡s antiguas",-1)])],512),[[me,j.value]])])]),e("div",da,[(r(),d(U,null,N(te,i=>e("button",{key:i.id,onClick:x=>ae(i.id),class:G(["flex-1 py-2 text-sm font-bold rounded-lg transition-all border border-transparent",t.value===i.id?"bg-white text-blue-600 shadow-sm border-gray-100":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"])},f(i.label),11,ca)),64))]),E(e("div",ua,[e("div",pa,[e("p",fa,f(_.value.length)+" PrÃ³ximas citas",1),E(e("div",ma,null,512),[[J,D.value]])]),_.value.length===0?(r(),d("div",ga,[p(u,{name:"md-eventbusy",scale:"2",class:"mb-2 text-gray-300"}),n[5]||(n[5]=h(" No se encontraron citas prÃ³ximas ",-1))])):C("",!0),e("div",xa,[(r(!0),d(U,null,N(_.value,(i,x)=>(r(),d("div",{key:i.docId||x},[p(ne,{data:i,index:x},null,8,["data","index"])]))),128))])],512),[[J,t.value==="proximas"]]),E(e("div",ba,[e("div",ya,[e("p",ha,f(W.value.length)+" Citas finalizadas ",1),E(e("div",va,null,512),[[J,D.value]])]),W.value.length===0?(r(),d("div",_a,[p(u,{name:"md-assignmentturnedin",scale:"2",class:"mb-2 text-gray-300"}),n[6]||(n[6]=h(" No se encontraron citas finalizadas ",-1))])):C("",!0),e("div",wa,[(r(!0),d(U,null,N(W.value,(i,x)=>(r(),d("div",{key:i.docId||x},[p(ne,{data:i,index:x},null,8,["data","index"])]))),128))])],512),[[J,t.value==="finalizadas"]]),E(e("div",Ca,[e("div",ka,[e("p",Fa,f(X.value.length)+" Citas canceladas ",1),E(e("div",Da,null,512),[[J,D.value]])]),X.value.length===0?(r(),d("div",Ea,[p(u,{name:"md-cancel-outlined",scale:"2",class:"mb-2 text-gray-300"}),n[7]||(n[7]=h(" No se encontraron citas canceladas ",-1))])):C("",!0),e("div",$a,[(r(!0),d(U,null,N(X.value,(i,x)=>(r(),d("div",{key:i.docId||x},[p(ne,{data:i,index:x},null,8,["data","index"])]))),128))])],512),[[J,t.value==="canceladas"]])])])}}}),za=we(Ua,[["__scopeId","data-v-cd78e851"]]);export{za as default};
